;/*FB_PKG_DELIM*/

__d("MAWReStoreDbSchema",[],(function(a,b,c,d,e,f){"use strict";a={auto_increment:!1,indexes:{userJid:["userJid","deviceJid"]},name:"e2ee_identity",primary_key:["deviceJid"]};b={auto_increment:!0,indexes:{externalId:["externalId","appDataId"]},name:"e2ee_appData",primary_key:["appDataId"]};c={auto_increment:!1,indexes:{},name:"e2ee_meta",primary_key:["key"]};d={auto_increment:!1,indexes:{},name:"e2ee_appMeta",primary_key:["key"]};e={auto_increment:!1,indexes:{},name:"e2ee_prekey",primary_key:["keyId"]};var g={auto_increment:!1,indexes:{},name:"e2ee_prekeyGeneration",primary_key:["generationId"]},h={auto_increment:!1,indexes:{},name:"e2ee_session",primary_key:["id"]},i={auto_increment:!1,indexes:{},name:"e2ee_signedPrekey",primary_key:["keyId"]},j={auto_increment:!1,indexes:{},name:"e2ee_tasks",primary_key:["taskName"]},k={auto_increment:!1,indexes:{},name:"e2ee_senderKeySessions",primary_key:["id"]},l={auto_increment:!1,indexes:{},name:"e2ee_personalSenderKeyStatuses",primary_key:["groupJid"]},m={auto_increment:!0,indexes:{"[thread+serverTs]":["thread","serverTs","rowId"],"[thread+sortOrderMs]":["thread","sortOrderMs","rowId"],altIndex:["altIndex","rowId"],externalId:["externalId","rowId"],messageDeleteTs:["messageDeleteTs","rowId"],messageExpirationTs:["messageExpirationTs","rowId"],msgId:["msgId","rowId"],quoteExternalId:["quoteExternalId","rowId"],revokedExternalId:["revokedExternalId","rowId"],unsendMsgContentDeleteTs:["unsendMsgContentDeleteTs","rowId"]},name:"e2ee_messages",primary_key:["rowId"]},n={auto_increment:!0,indexes:{"[thread+sortOrderMs]":["thread","sortOrderMs","rowId"],externalId:["externalId","rowId"],messageDeleteForMeTs:["messageDeleteForMeTs","rowId"],msgId:["msgId","rowId"],sortOrderMs:["sortOrderMs","rowId"],thread:["thread","rowId"],threadJid:["threadJid","rowId"]},name:"e2ee_unrenderedMessages",primary_key:["rowId"]},o={auto_increment:!0,indexes:{deleteTs:["deleteTs","rowId"],externalIdWithType:["externalIdWithType","rowId"]},name:"e2ee_pendingStanzas",primary_key:["rowId"]},p={auto_increment:!0,indexes:{associatedMessageId:["associatedMessageId","xmaId"],defaultPreviewMediaId:["defaultPreviewMediaId","xmaId"],externalId:["externalId","xmaId"],faviconMediaId:["faviconMediaId","xmaId"],headerMediaId:["headerMediaId","xmaId"],targetExpiringAtSec:["targetExpiringAtSec","xmaId"]},name:"e2ee_xma",primary_key:["xmaId"]},q={auto_increment:!1,indexes:{threadId:["threadId","groupJid"]},name:"e2ee_groupInfo",primary_key:["groupJid"]},r={auto_increment:!1,indexes:{threadId:["threadId","id"],userJid:["userJid","id"]},name:"e2ee_participants",primary_key:["id"]},s={auto_increment:!1,indexes:{},name:"e2ee_contacts",primary_key:["contactJid"]},t={auto_increment:!1,indexes:{},name:"e2ee_receipts",primary_key:["msgId"]},u={auto_increment:!0,indexes:{fbid:["fbid","mediaId"],hashedPlaintextHash:["hashedPlaintextHash"],objectId:["objectId","mediaId"]},name:"e2ee_media",primary_key:["mediaId"]},v={auto_increment:!0,indexes:{externalId:["externalId","rowId"],reactionId:["reactionId","rowId"],reactToExternalId:["reactToExternalId","rowId"],reactToMsgId:["reactToMsgId","rowId"],threadJid:["threadJid","rowId"]},name:"e2ee_reactions",primary_key:["rowId"]},w={auto_increment:!0,indexes:{hashedPlaintextHash:["hashedPlaintextHash","chunkId"]},name:"e2ee_chunk",primary_key:["chunkId"]},x={auto_increment:!0,indexes:{mediaId:["mediaId","mediaBackupId"],msgId:["msgId","mediaBackupId"],objectId:["objectId"]},name:"e2ee_mediaBackup",primary_key:["mediaBackupId"]},y={auto_increment:!0,indexes:{authoritativeThreadKey:["authoritativeThreadKey","chatId"],deduplicationKey:["deduplicationKey","chatId"],jid:["jid","chatId"],threadOrder:["threadOrder","chatId"]},name:"e2ee_threads",primary_key:["chatId"]},z={auto_increment:!0,indexes:{},name:"e2ee_isDualSend",primary_key:["rowId"]},A={auto_increment:!0,indexes:{dbVersion:["number","staleQueueId"]},name:"e2ee_staleQueue",primary_key:["staleQueueId"]},B={auto_increment:!0,indexes:{"[jid+type]":["jid","type","stanzaQueueId"],jid:["jid","stanzaQueueId"],stanzaId:["stanzaId","stanzaQueueId"],type:["type","stanzaQueueId"]},name:"e2ee_stanzaQueue",primary_key:["stanzaQueueId"]},C={auto_increment:!1,indexes:{},name:"e2ee_existingUsers",primary_key:["id"]},D={auto_increment:!1,indexes:{},name:"e2ee_pendingReceipts",primary_key:["id"]},E={auto_increment:!1,indexes:{},name:"e2ee_groupInvites",primary_key:["invitedParticipantId","inviterJid"]},F={auto_increment:!0,indexes:{},name:"e2ee_deviceChangeAlerts",primary_key:["deviceChangeAlertsId"]},G={auto_increment:!0,indexes:{originalMsgExternalId:["originalMsgExternalId","editMsgHistoryId"],threadJid:["threadJid","editMsgHistoryId"]},name:"e2ee_editMsgHistory",primary_key:["editMsgHistoryId"]},H={auto_increment:!1,indexes:{},name:"e2ee_retroactiveBackupsState",primary_key:["threadId"]},I={auto_increment:!0,indexes:{version:["version"]},name:"e2ee_browserEncryptionMeta",primary_key:["id"]},J={auto_increment:!0,indexes:{collection:["collection"]},name:"e2ee_collectionVersions",primary_key:["id"]},K={auto_increment:!0,indexes:{},name:"e2ee_dualSendMedia",primary_key:["id"]},L={auto_increment:!0,indexes:{},name:"e2ee_dyiBatch",primary_key:["batchId"]},M={auto_increment:!1,indexes:{},name:"e2ee_historySyncQRCodeData",primary_key:["rowId"]},N={auto_increment:!1,indexes:{},name:"e2ee_historySyncQRCodeSecretKey",primary_key:["key"]},O={auto_increment:!1,indexes:{},name:"e2ee_missingKeys",primary_key:["keyHex"]},P={auto_increment:!0,indexes:{action:["action","id"],collection:["collection","id"],index:["index","id"]},name:"e2ee_pendingMutations",primary_key:["id"]},Q={auto_increment:!1,indexes:{"[modelId+modelType+actionState]":["modelId","modelType","actionState","index"],action:["action","index"],actionState:["actionState","index"],collection:["collection","index"],indexMac:["indexMac","index"]},name:"e2ee_syncActions",primary_key:["index"]},R={auto_increment:!0,indexes:{keyEpoch:["keyEpoch","id"],keyId:["keyId"]},name:"e2ee_syncKeys",primary_key:["id"]},S={auto_increment:!1,indexes:{lastRetryTs:["lastRetryTs","externalId"],traceId:["traceId","externalId"]},name:"e2ee_uploadRetryStatus",primary_key:["externalId","lastRetryTs"]},T={auto_increment:!0,indexes:{},name:"e2ee_ebRestoreQueue",primary_key:["queueId"]},U={auto_increment:!0,indexes:{},name:"e2ee_ebUploadQueue",primary_key:["queueId"]},V={auto_increment:!0,indexes:{},name:"e2ee_danglingQueue",primary_key:["queueId"]};b=[b,d,a,c,e,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,L,S,I,J,K,M,N,O,P,Q,R,T,U,V];f.clientSchema=b}),66);
__d("isArmadillo",["qex"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("qex")._("135")===!0}g["default"]=a}),98);
__d("hashString",[],(function(a,b,c,d,e,f){"use strict";function a(a){var b=0;for(var c=0;c<a.length;c++){var d=a.charCodeAt(c);b=(b<<5)-b+d;b|=0}return b}f["default"]=a}),66);
__d("isInstamadillo",["qex"],(function(a,b,c,d,e,f,g){"use strict";function a(){return c("qex")._("548")===!0}g["default"]=a}),98);
__d("ReStoreVaulting",["cr:2075","cr:2151","cr:2203"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return b("cr:2075")!=null?b("cr:2075").vault(a):a}function c(a){return b("cr:2075")!=null?b("cr:2075").unvault(a):a}function d(a,c){return b("cr:2151")!=null&&b("cr:2203")!=null?b("cr:2151").unvaultDbRow(a,c,b("cr:2203").PERSISTED_DB_VAULT_DEFINITIONS):a}function e(a,c){return b("cr:2151")!=null&&b("cr:2203")!=null?b("cr:2151").vaultDbRow(a,c,b("cr:2203").PERSISTED_DB_VAULT_DEFINITIONS):a}g.maybeVault=a;g.maybeUnvault=c;g.maybeUnvaultDbRow=d;g.maybeVaultDbRow=e}),98);
__d("MAWLSVaultingHooks",["ReStoreVaulting"],(function(a,b,c,d,e,f,g){"use strict";a={onAfterEntriesNext:function(a){var b=a.tableName;a=a.value;return d("ReStoreVaulting").maybeVaultDbRow(a,b)},onAfterGet:function(a){var b=a.tableName;a=a.value;return d("ReStoreVaulting").maybeVaultDbRow(a,b)},onBeforeAdd:function(a){var b=a.tableName;a=a.value;return d("ReStoreVaulting").maybeUnvaultDbRow(a,b)},onBeforeDeleteThenInsert:function(a){var b=a.tableName;a=a.value;return d("ReStoreVaulting").maybeUnvaultDbRow(a,b)},onBeforeNotify:function(a){var b=a.newValue,c=a.prevValue;a=a.tableName;return{newValue:d("ReStoreVaulting").maybeVaultDbRow(b,a),prevValue:d("ReStoreVaulting").maybeVaultDbRow(c,a)}},onBeforePut:function(a){var b=a.tableName;a=a.value;return d("ReStoreVaulting").maybeUnvaultDbRow(a,b)},onBeforeUpsert:function(a){var b=a.tableName;a=a.value;return d("ReStoreVaulting").maybeUnvaultDbRow(a,b)}};g["default"]=a}),98);
__d("LSStorage",["ReStoreKeyComparer","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a,b,d,e){a=a.tableNames[b];b=a.indexes;a=a.primaryKeyIds;a=e==null?a:b[e];return a.map(function(a){if(d[a]!==void 0||e!=null)return d[a];throw c("unrecoverableViolation")("primary key must be defined on object","messenger_web_product")})}function b(a,b){return(h||(h=d("ReStoreKeyComparer"))).compareKey(a,b)===0}g.searchKey=a;g.areKeysEqual=b}),98);
__d("LSDbSchema",["MAWReStoreDbSchema"],(function(a,b,c,d,e,f){"use strict";a=importNamespace("MAWReStoreDbSchema").clientSchema;f.clientSchema=a}),66);
__d("ReStoreTransactionLock",["isPromise"],(function(a,b,c,d,e,f,g){"use strict";var h;a=function(){function a(a){var b=this;this.waitFor=null;a!=null&&(this.waitFor=a.then(function(a){return b.waitFor=null}))}var b=a.prototype;b.chainPromiseOrValue=function(a){if(this.waitFor!=null)return this.waitFor.then(function(){return a("\ud83d\udd12")});else return a("\ud83d\udd12")};return a}();b=function(){function a(){this.lock=null}var b=a.prototype;b.chainPromiseOrValue=function(a){var b=this,d=this.lock;if(d==null){var e=a("\ud83d\udd12");if((h||(h=c("isPromise")))(e))d=e;else return e}else d=d.then(function(){return a("\ud83d\udd12")});var f=d["finally"](function(a){b.lock===f&&(b.lock=null);return a});this.lock=f;return f};return a}();g.WaitForPromiseLock=a;g.ReStoreTransactionLock=b}),98);
__d("LSDbForeignKeys",[],(function(a,b,c,d,e,f){"use strict";a={attachments:[{indexName:"fk_attachments",tableName:"attachment_items"},{indexName:"fk_attachments",tableName:"attachment_ctas"}],community_chat_poll_options:[{tableName:"community_chat_poll_votes"}],community_chat_polls:[{tableName:"community_chat_poll_options"},{tableName:"community_chat_poll_votes"}],data_trace_meta:[{indexName:"traceIdAddonId",tableName:"data_trace_addon"}],messages:[{indexName:"fk_messages",tableName:"attachments"}],pending_tasks:[{tableName:"encrypted_backup_restore_task_payload_context"},{indexName:"fk_pending_tasks",tableName:"pending_backups_context_v2"},{indexName:"fk_pending_tasks",tableName:"secure_recovery_code_data"},{indexName:"fk_pending_tasks",tableName:"secure_encrypted_backups_message_thread_id_context"}],rooms:[{tableName:"room_participants"}],secure_encrypted_backups_client_state:[{indexName:"fk_secure_encrypted_backups_client_state",tableName:"secure_encrypted_backups_epochs"}],secure_encrypted_backups_devices:[{indexName:"fk_secure_encrypted_backups_device_supported_versions_device_id",tableName:"secure_encrypted_backups_device_supported_versions"}],threads:[{indexName:"threadKeyCtaId",tableName:"thread_nullstate_ctas"},{tableName:"messages"},{tableName:"attachments"},{tableName:"thread_nullstate"},{tableName:"messages_ranges_v2__generated"},{tableName:"participants"},{indexName:"fk_threads",tableName:"mi_act_mapping_table"}]};b=a;f["default"]=b}),66);
__d("LSTableSchemas",[],(function(a,b,c,d,e,f){e.exports=[[{name:"sync_groups",id:1,primary_key:["groupId"]},{name:"pending_tasks",id:2,primary_key:["taskId"],indexes:{queueNameTaskId:["queueName","taskId"]},auto_increment:!0},{name:"network_requests",id:3,primary_key:["taskQueueName","syncDatabaseId"]},{name:"_user_info",id:4,primary_key:["id"]},{name:"pending_fire_and_forget_tasks",id:5,primary_key:["taskId"],auto_increment:!0},{name:"user_visible_errors",id:6,primary_key:["errorId"],auto_increment:!0},{name:"mailbox_task_completion_notification_context",id:232,primary_key:["notificationScopeKey"]},{name:"mailbox_task_completion_api_tasks",id:233,primary_key:["taskId"]}],[{name:"contacts",id:7,primary_key:["id"],indexes:{blockedByViewerStatusId:["blockedByViewerStatus","id"]}},{name:"ig_contact_info",id:176,primary_key:["contactId"]},{name:"work_contact_info",id:210,primary_key:["id"]},{name:"contextual_profile_v1",id:216,primary_key:["ownerId","associatedEntityId"],indexes:{associatedEntityIdAndOwner:["associatedEntityId","ownerId"]}},{name:"profile_sheet_information",id:256,primary_key:["userId"]},{name:"fb_transport_contacts",id:240,primary_key:["pk"]},{name:"bot_profile_info_v2",id:299,primary_key:["botId"]}],[{name:"reactions",id:8,primary_key:["threadKey","messageId","actorId"]},{name:"threads",id:9,primary_key:["threadKey"],indexes:{lastActivityTimestampMs:["lastActivityTimestampMs","threadKey"],parentThreadKeyLastActivityTimestampMs:["parentThreadKey","lastActivityTimestampMs","threadKey"],secondaryParentThreadKeyLastActivityTimestampMs:["secondaryParentThreadKey","lastActivityTimestampMs","threadKey"],clientThreadKey:["clientThreadKey","threadKey"],threadTypeLastActivityTimestampMs:["threadType","lastActivityTimestampMs","threadKey"],syncGroupParentThreadKeyLastActivityTimestampMs:["syncGroup","parentThreadKey","lastActivityTimestampMs","threadKey"]}},{name:"threads_ranges_v2__generated",id:10,primary_key:["parentThreadKey","minThreadKey","minLastActivityTimestampMs"]},{name:"messages",id:12,primary_key:["threadKey","timestampMs","messageId"],indexes:{optimistic:["offlineThreadingId"],messageDisplayOrder:["threadKey","primarySortKey","secondarySortKey","messageId","isCollapsed"],messageId:["messageId"],messageSubthreadKey:["subthreadKey","primarySortKey","secondarySortKey","messageId","isCollapsed"]}},{name:"messages_ranges_v2__generated",id:13,primary_key:["threadKey","minTimestampMs","minMessageId"]},{name:"participants",id:14,primary_key:["threadKey","contactId"],indexes:{threadKeyReadWatermarkTimestampMs:["threadKey","readWatermarkTimestampMs","contactId"],threadKeyDeliveredWatermarkTimestampMs:["threadKey","deliveredWatermarkTimestampMs","contactId"]}},{name:"ctas",id:15,primary_key:["ctaId"]},{name:"attachments",id:16,primary_key:["threadKey","messageId","attachmentFbid"],indexes:{fk_messages:["threadKey","timestampMs","messageId","attachmentFbid"],idx_attachments_collapsible_id:["threadKey","collapsibleId","messageId","attachmentFbid"]}},{name:"attachments_ranges_v2__generated",id:17,primary_key:["threadKey","mediaGroup","minTimestampMs"]},{name:"attachment_items",id:18,primary_key:["attachmentFbid","attachmentIndex"],indexes:{fk_attachments:["threadKey","messageId","attachmentFbid","attachmentIndex"]}},{name:"attachment_ctas",id:19,primary_key:["ctaId"],indexes:{fk_attachments:["threadKey","messageId","attachmentFbid","ctaId"]}},{name:"quick_reply_ctas",id:20,primary_key:["threadKey","messageId","ctaId"]},{name:"m_suggestions",id:21,primary_key:["threadKey","timestampMs","suggestionId"]},{name:"rtc_signals",id:22,primary_key:["timestampMs","type_"]},{name:"rtc_ongoing_calls_on_threads_v2",id:23,primary_key:["threadKey"]},{name:"rtc_multiway_call_initiation_conference_names",id:24,primary_key:["threadKey"]},{name:"mailbox_metadata",id:25,primary_key:["id"]},{name:"group_membership_approval_requests",id:26,primary_key:["threadKey","contactId"]},{name:"admin_message_ctas",id:27,primary_key:["threadKey","messageId","ctaId"],indexes:{ctaId:["ctaId"]}},{name:"thread_nullstate",id:28,primary_key:["threadKey"]},{name:"thread_nullstate_ctas",id:29,primary_key:["ctaId"],indexes:{threadKeyCtaId:["threadKey","ctaId"]}},{name:"focus_mode_ctas",id:30,primary_key:["threadKey","messageId","ctaId"]},{name:"messages_optimistic_context",id:31,primary_key:["taskId"]},{name:"threads_optimistic_context",id:32,primary_key:["taskId"]},{name:"messages_status",id:33,primary_key:["messageId","threadKey","timestampMs","threadKeyFromParticipants","contactId","type_"]},{name:"message_requests",id:34,primary_key:["threadKey"]},{name:"folder_metadata",id:35,primary_key:["parentThreadKey"]},{name:"polls",id:38,primary_key:["pollId"]},{name:"poll_options_v2",id:39,primary_key:["pollId","optionId"]},{name:"poll_votes_v2",id:40,primary_key:["pollId","optionId","contactId"]},{name:"pinned_messages_v2",id:155,primary_key:["threadKey","messageId"]},{name:"filtered_threads_ranges_v3__generated",id:247,primary_key:["parentThreadKey","minThreadKey","minLastActivityTimestampMs","threadRangeFilter","folderName","secondaryThreadRangeFilter","threadRangeFilterValue"]},{name:"community_folders",id:162,primary_key:["folderId"],indexes:{byFbGroupId:["fbGroupId","folderId"]}},{name:"community_members",id:170,primary_key:["communityId","contactId","source","requestId"],indexes:{communitySource:["communityId","source","requestId","contactId","name"],communityContact:["communityId","contactId","requestId","source","name"]}},{name:"community_members_ranges_v2__generated",id:189,primary_key:["communityId","isAdmin","minName","source","requestId"]},{name:"attachment_conversion",id:164,primary_key:["attachmentFbid"]},{name:"saved_messages",id:165,primary_key:["threadKey","messageId"]},{name:"rtc_rooms_on_threads",id:181,primary_key:["threadKey"]},{name:"ig_thread_info",id:194,primary_key:["threadKey"],indexes:{igThreadID:["igThreadId"]}},{name:"group_invites",id:197,primary_key:["threadKey","inviterId","inviteeId"],indexes:{threadKeyInviterIDInviteeID:["threadKey","inviterId","inviteeId"]}},{name:"inbox_threads_ranges",id:198,primary_key:["syncGroup"]},{name:"community_direct_invites_presets",id:199,primary_key:["communityId","presetType","source"]},{name:"msg_pinned_messages_v2",id:205,primary_key:["threadKey","messageId","pinnedTimestampMs"],indexes:{pinnedMessageDisplayOrder:["threadKey","pinnedTimestampMs","messageId"]}},{name:"filtered_messages_ranges_v2__generated",id:211,primary_key:["threadKey","mailboxType","minTimestampMs","minMessageId","messageRangeFilter"]},{name:"taken_down_threads",id:212,primary_key:["threadKey"]},{name:"participant_list_queries",id:219,primary_key:["threadKey"]},{name:"sync_group_threads_ranges",id:220,primary_key:["syncGroup","parentThreadKey"]},{name:"community_chat_message_seen_count",id:221,primary_key:["threadKey","messageId"]},{name:"community_chat_polls",id:223,primary_key:["pollId"]},{name:"community_chat_poll_options",id:224,primary_key:["pollId","optionId"]},{name:"community_chat_poll_votes",id:225,primary_key:["pollId","optionId","contactId"]},{name:"reactions_v2",id:226,primary_key:["threadKey","messageId","reactionFbid","messageTimestamp"],indexes:{optimistic:["threadKey","messageId","reactionFbid"]}},{name:"reactions_v2_details_users",id:227,primary_key:["reactorId","reactionFbid"]},{name:"reactions_v2_details_users_ranges_v2__generated",id:228,primary_key:["reactorId","reactionFbid","minTimestampMs"]},{name:"reaction_v2_types",id:229,primary_key:["reactionFbid"]},{name:"bots",id:230,primary_key:["threadKey","botId"]},{name:"business_comm_items",id:234,primary_key:["threadKey","entId"]},{name:"group_invitations_pending",id:235,primary_key:["linkHash"]},{name:"business_support_notification_settings",id:236,primary_key:["userId"]},{name:"thread_label_mappings",id:237,primary_key:["threadKey","labelId"]},{name:"inbox_view_state",id:277,primary_key:["interface_","configName"]},{name:"inbox_view_state_v2",id:281,primary_key:["configName"]},{name:"audio_channel_events",id:238,primary_key:["eventId","roomId"]},{name:"reactions_v2_details",id:239,primary_key:["threadId","messageId","reactorId","reactionFbid"]},{name:"reactions_v2_details_ranges_v2__generated",id:243,primary_key:["threadId","messageId","reactionFbid","minTimestampMs"]},{name:"community_chat_poll_votes_ranges_v2__generated",id:244,primary_key:["pollId","optionId","minTimestampMs"]},{name:"discoverable_chat_participants",id:248,primary_key:["threadId","contactId","source"]},{name:"discoverable_chat_participants_ranges_v2__generated",id:249,primary_key:["threadId","source","minName"]},{name:"roll_calls",id:250,primary_key:["rollCallId","threadKey"]},{name:"community_surface_ranges",id:253,primary_key:["surfaceType","communityKey"]},{name:"community_rules",id:254,primary_key:["communityId","ruleId"]},{name:"roll_call_contributions_v2",id:255,primary_key:["rollCallContributionId","rollCallId","messageId","messageTimestampMs","threadKey"],indexes:{optimistic:["rollCallContributionId","rollCallId","messageId","messageTimestampMs"]}},{name:"business_thread_info",id:260,primary_key:["threadKey"]},{name:"thread_creation_status",id:278,primary_key:["taskId"]},{name:"shared_albums",id:279,primary_key:["sharedAlbumId","threadKey"]},{name:"shared_album_contributions",id:280,primary_key:["sharedAlbumId","sharedAlbumContributionId","threadKey","messageId"]},{name:"shared_albums_multimedia_upload_jobs",id:283,primary_key:["offlineThreadingId"]},{name:"shared_albums_multimedia_upload_subjobs_status",id:284,primary_key:["offlineThreadingId","jobId"]},{name:"thread_point_query_ttrc",id:286,primary_key:["threadKey"]},{name:"business_thread_suggestions",id:290,primary_key:["threadKey","suggestionType"]},{name:"community_chat_admin_assist_command_sequences",id:291,primary_key:["commandSequenceId"]},{name:"community_thread_sync_info",id:294,primary_key:["threadKey"]},{name:"thread_bans",id:297,primary_key:["threadKey","contactId"]},{name:"support_translations",id:300,primary_key:["messageId","targetLocale"]},{name:"threads_optimistic_metadata",id:312,primary_key:["threadKey"]}],[{name:"media_send_jobs",id:51,primary_key:["offlineAttachmentId"]}],[{name:"typing_indicator",id:52,primary_key:["threadKey","senderId"]}],[{name:"server_search_results",id:65,primary_key:["query","resultId","globalIndex"]},{name:"server_search_sections",id:66,primary_key:["query","globalIndex"]},{name:"search_queries",id:67,primary_key:["query","surfaceType"]},{name:"universal_search_recent_searches",id:68,primary_key:["resultId"]},{name:"message_search_results",id:69,primary_key:["type_","query","threadKey","globalIndex"]},{name:"message_search_queries",id:70,primary_key:["type_","query","threadKeyV2"]},{name:"participant_search_queries",id:214,primary_key:["query","threadKey"]}],[{name:"cm_search_nullstate_metadata",id:289,primary_key:["threadKey","scoreType"]}],[{name:"ai_bot_search_metadata",id:298,primary_key:["botId"]}],[{name:"contact_upload_settings",id:74,primary_key:["userid"]},{name:"gdpr_settings",id:75,primary_key:["userid"]},{name:"presence_settings",id:187,primary_key:["userId"]},{name:"persistent_menu_items",id:77,primary_key:["threadKey","ctaId"]},{name:"video_chat_links_joining",id:78,primary_key:["url","optimisticClientToken"],indexes:{optimistic:["optimisticClientToken"]}},{name:"video_chat_links_attempted_joiners",id:79,primary_key:["userId","url"]},{name:"cowatch_sessions",id:80,primary_key:["cowatchSessionId"]},{name:"self_profile",id:81,primary_key:["userId"]},{name:"pinned_threads",id:82,primary_key:["threadKey"],indexes:{pinnedTimestamp:["pinnedTimestamp","threadKey"]}},{name:"messaging_settings",id:83,primary_key:["id"]},{name:"reachability_settings",id:148,primary_key:["audience"]},{name:"feature_limits",id:150,primary_key:["type_"]},{name:"emoji_sets",id:151,primary_key:["categoryIdx","emojiIdx","type_"]},{name:"epd_cookie_settings",id:163,primary_key:[]},{name:"cm_community_list",id:166,primary_key:["communityId"]},{name:"cm_channel_list",id:167,primary_key:["communityId","threadId"],indexes:{threadIdCommunityId:["threadId","communityId"]}},{name:"cm_category_list",id:182,primary_key:["communityId","categoryId"]},{name:"notification_settings",id:175,primary_key:["id"]},{name:"encrypted_backups_status_trigger",id:195,primary_key:["pk"],auto_increment:!0},{name:"fb_events",id:200,primary_key:["eventId"]},{name:"cm_channel_events",id:201,primary_key:["eventId","threadId"],indexes:{eventsInThread:["threadId","eventId"]}},{name:"community_events",id:202,primary_key:["eventId","communityId"]},{name:"avatar_settings",id:209,primary_key:["threadId"]},{name:"thread_labels",id:215,primary_key:["labelId"]},{name:"thread_limits",id:287,primary_key:["threadKey"]},{name:"business_support_case_details",id:222,primary_key:["threadId"]},{name:"messaging_privacy_settings",id:288,primary_key:["userId"]},{name:"rtc_call_events",id:245,primary_key:["pk"],auto_increment:!0},{name:"custom_thread_commands",id:296,primary_key:["threadKey","commandId"],indexes:{rank:["threadKey","rank"],commandId:["commandId"]}}],[{name:"payment_type_paypal",id:85,primary_key:["paymentCredentialId"]},{name:"payment_type_card",id:86,primary_key:["paymentCredentialId"]},{name:"payment_type_bank_v2",id:88,primary_key:["paymentMethodId"]},{name:"payment_method",id:89,primary_key:["paymentMethodId"]},{name:"new_payment_credential_option",id:90,primary_key:["credentialType"]},{name:"paypal_funding_options",id:91,primary_key:["optionId"]},{name:"payments_eligibility",id:92,primary_key:["userId"]},{name:"payments_ofac_blacklisted_countries",id:93,primary_key:["isoCountryCode"]},{name:"p2m_invoice",id:94,primary_key:["orderId"]},{name:"p2m_invoice_attachment",id:95,primary_key:["orderId","productItemId"]},{name:"payment_price_list_item",id:96,primary_key:["orderId","id"]},{name:"p2m_charge",id:97,primary_key:["orderId"]},{name:"payment_p2p_risk_verification",id:98,primary_key:["requestId","transactionId"]},{name:"payment_transaction_v2",id:99,primary_key:["timestampMs","transactionId"],indexes:{optimistic:["optimisticTransactionId"]}},{name:"p2p_request_v2",id:100,primary_key:["timestampMs","transactionId"],indexes:{optimistic:["optimisticTransactionId"]}},{name:"p2p_transfer_v2",id:101,primary_key:["timestampMs","transactionId"],indexes:{optimistic:["optimisticTransactionId"]}},{name:"transaction_history",id:102,primary_key:["transactionId"]},{name:"payments_transaction_details_core",id:103,primary_key:["transactionId"]},{name:"payments_transaction_details_ctas",id:104,primary_key:["transactionId","ctaId"]},{name:"payments_transaction_details_rows",id:105,primary_key:["transactionId","rowOrder"]},{name:"payment_user_auth",id:106,primary_key:["userId"]},{name:"payment_client_auth_token",id:107,primary_key:["userId","deviceId","appId"]},{name:"payment_auth_request_results",id:108,primary_key:["requestId"]},{name:"payment_server_request_results",id:109,primary_key:["requestId"]},{name:"payment_pin_verification_results",id:113,primary_key:["requestId"]}],[{name:"connectivity_status",id:114,primary_key:["statusId"],auto_increment:!0},{name:"user_visible_network_connectivity_error",id:115,primary_key:["statusId"],auto_increment:!0}],[{name:"thread_themes",id:116,primary_key:["fbid"]},{name:"gradient_colors",id:117,primary_key:["themeFbid","gradientIndex"]}],[{name:"in_thread_banner",id:118,primary_key:["threadKey","bannerId"]},{name:"in_thread_banner_ctas",id:119,primary_key:["bannerId","ctaId"]},{name:"in_thread_banner_overflow_menu",id:120,primary_key:["threadKey","bannerId"]}],[{name:"stickers",id:121,primary_key:["stickerId"],indexes:{stickerPackId:["stickerPackId","stickerId"]}},{name:"sticker_packs",id:122,primary_key:["packId"]},{name:"sticker_search_results",id:123,primary_key:["resultIndex","query","type_"]},{name:"sticker_search_queries",id:124,primary_key:["query"]},{name:"sticker_search_featured_tags",id:125,primary_key:["tagIndex"]},{name:"sticker_to_collection",id:126,primary_key:["stickerId","collectionId"]},{name:"sticker_pack_details",id:127,primary_key:["packId"]},{name:"sticker_store_pack_indices",id:128,primary_key:["packId"]}],[{name:"forward_content",id:129,primary_key:["value","type_"]}],[{name:"linked_groups",id:130,primary_key:["id"],indexes:{threadKey:["threadKey"]}}],[{name:"ranking_scores",id:134,primary_key:["contactId","scoreType"],indexes:{scoreTypeContactId:["scoreType","contactId"]}},{name:"ranking_requests",id:135,primary_key:["scoreType"]},{name:"value_model_rules",id:136,primary_key:["product","ruleIndex"]},{name:"value_model_features",id:137,primary_key:["feature"]},{name:"value_model_output",id:138,primary_key:["product","contactId"]}],[{name:"story_buckets",id:53,primary_key:["bucketId"],indexes:{optimistic:["ownerId","bucketType"]}},{name:"stories",id:54,primary_key:["storyId"],indexes:{optimistic:["optimisticClientId"]}},{name:"story_viewers",id:55,primary_key:["storyId","viewerContactId","interactionType"]},{name:"story_reactions",id:56,primary_key:["reactionId"],indexes:{optimistic:["optimisticClientId"]}},{name:"story_ad_unit",id:57,primary_key:["adPosition","clientToken"]},{name:"story_ad_card",id:58,primary_key:["adPosition","clientToken","cardId"]},{name:"story_ad_ctas",id:59,primary_key:["ctaId"]},{name:"story_overlays",id:60,primary_key:["storyId","storyOverlayId"]},{name:"story_buckets_paginated_queries",id:61,primary_key:["queryId"]},{name:"status",id:62,primary_key:["statusId"],indexes:{optimistic:["optimisticClientId"]}},{name:"rooms",id:63,primary_key:["roomId"],indexes:{optimistic:["optimisticClientToken"]}},{name:"room_participants",id:64,primary_key:["roomId","participantId","type_"],indexes:{optimistic:["roomId","participantId"]}}],[{name:"live_location_sharers",id:149,primary_key:["threadKey","userId"]}],[{name:"mi_act_mapping_table",id:173,primary_key:["serverThreadKey","clientThreadPk","jid"],indexes:{fk_threads:["serverThreadKey"],chat_id:["clientThreadPk"],jid:["jid"]}},{name:"media_staging",id:161,primary_key:["offlineAttachmentId"]},{name:"client_accounts",id:272,primary_key:["pk"]},{name:"client_messages",id:273,primary_key:["pk"]},{name:"client_participants",id:274,primary_key:["pk"]},{name:"client_threads",id:276,primary_key:["pk"]}],[{name:"webact_thread",id:262,primary_key:["chatId"],indexes:{jid:["jid"],thread_order:["threadOrder"],deduplication_key:["deduplicationKey"],authoritative_thread_key:["authoritativeThreadKey"]},auto_increment:!0},{name:"webact_group_info",id:263,primary_key:["groupJid"],indexes:{thread_id:["threadId"],corresponding_open_thread_key:["correspondingOpenThreadKey"]}},{name:"webact_group_invite",id:264,primary_key:["inviterJid","invitedParticipantId"],indexes:{inviter_jid:["inviterJid"]}},{name:"webact_xma",id:265,primary_key:["xmaId"],indexes:{external_id:["externalId"],associated_message_id:["associatedMessageId"],favicon_media_id:["faviconMediaId"],header_media_id:["headerMediaId"],target_expiring_at_sec:["targetExpiringAtSec"],default_preview_media_id:["defaultPreviewMediaId"]}},{name:"webact_tasks",id:266,primary_key:["taskName"]},{name:"webact_sync_keys",id:267,primary_key:["id"],indexes:{key_id:["keyId"],key_epoch:["keyEpoch"]}},{name:"webact_reaction",id:268,primary_key:["rowId"],indexes:{reaction_id:["reactionId"],external_id:["externalId"],react_to_msg_id:["reactToMsgId"],thread_jid:["threadJid"],react_to_external_id:["reactToExternalId"]}},{name:"webact_participant",id:269,primary_key:["id"],indexes:{thread_id:["threadId"],user_jid:["userJid"]}},{name:"webact_device_change_alerts",id:270,primary_key:["deviceChangeAlertsId"]},{name:"webact_dyi_batch",id:271,primary_key:["batchId"]}],[{name:"data_trace_meta",id:153,primary_key:["traceId"],indexes:{shouldFlushInitTimestampMsTraceId:["shouldFlush","initTimestampMs","traceId"]}},{name:"data_trace_addon",id:154,primary_key:["addonId"],indexes:{traceIdAddonId:["traceId","addonId"]},auto_increment:!0}],[{name:"ad_context",id:160,primary_key:["adId"]}],[{name:"thread_proactive_warning_settings",id:183,primary_key:["threadKey"]},{name:"client_thread_proactive_warning_settings",id:241,primary_key:["threadPk"]}],[{name:"presence_states",id:186,primary_key:["contactId"],indexes:{statusContactId:["status","contactId"]}}],[{name:"available_reactions",id:188,primary_key:["emojiIdx"]}],[{name:"pending_backups_context_v2",id:177,primary_key:["pk"],indexes:{fk_pending_tasks:["pendingBackupTaskId"]},auto_increment:!0},{name:"secure_encrypted_backups_client_state",id:168,primary_key:["backupId"]},{name:"encrypted_backups_debug_metadata",id:206,primary_key:["backupId"]},{name:"encrypted_backups_epoch_debug_metadata",id:207,primary_key:["epochId"]},{name:"encrypted_backups_debug_metadata_v2",id:217,primary_key:["backupId"]},{name:"encrypted_backups_epoch_debug_metadata_v2",id:218,primary_key:["epochId"]},{name:"secure_encrypted_backups_epochs",id:169,primary_key:["epochId"],indexes:{fk_secure_encrypted_backups_client_state:["backupId","epochId"]}},{name:"encrypted_backups",id:172,primary_key:["pk"],auto_increment:!0},{name:"secure_encrypted_backups_generated_recovery_code",id:174,primary_key:["pk"]},{name:"secure_encrypted_backups_recovery_code_status",id:178,primary_key:["pk"]},{name:"secure_recovery_code_data",id:179,primary_key:["taskId"],indexes:{fk_pending_tasks:["taskId"]}},{name:"secure_encrypted_backups_message_thread_id_context",id:180,primary_key:["taskId","listId"],indexes:{fk_pending_tasks:["taskId"]}},{name:"encrypted_backups_virtual_devices",id:184,primary_key:["pk"],auto_increment:!0},{name:"encrypted_backups_metadata",id:196,primary_key:["backupId"]},{name:"device_metadata",id:185,primary_key:["pk"]},{name:"encrypted_backup_restore_task_payload_context",id:190,primary_key:["taskId"]},{name:"encrypted_backups_dyi_backup_restore_status",id:208,primary_key:["pk"]},{name:"encrypted_backups_message_backup_status",id:213,primary_key:["messagePk"]},{name:"encrypted_backups_client_restore_status",id:231,primary_key:["threadId"]},{name:"third_party_id_store",id:242,primary_key:["platform"]},{name:"secure_get_secrets_context",id:259,primary_key:["deviceRegistrationId"]},{name:"encrypted_backups_otc_devices",id:261,primary_key:["deviceId"]},{name:"experiences_shared_state",id:282,primary_key:["stateKey"]},{name:"encrypted_backups_otc_notification_sending_status",id:285,primary_key:["pk"]},{name:"pending_protobuf_backups_context",id:305,primary_key:["pk"],auto_increment:!0}],[{name:"secure_encrypted_backups_devices",id:191,primary_key:["deviceId"]},{name:"secure_encrypted_backups_device_supported_versions",id:192,primary_key:["deviceId","supportedVersion"],indexes:{fk_secure_encrypted_backups_device_supported_versions_device_id:["deviceId","supportedVersion"]}}],[{name:"e2ee_dummy_table_for_sync",id:171,primary_key:["placeholder"]},{name:"cutover_threads",id:193,primary_key:["openThreadId"]},{name:"occamadillo_most_recent_message_per_thread",id:292,primary_key:["threadKey"]},{name:"offline_queue_thread_status",id:295,primary_key:["threadJid"]}],[{name:"community_messaging_aggregated_user_presence_counts_for_community",id:203,primary_key:["folderId"]},{name:"community_messaging_aggregated_copresence_counts_for_chat",id:204,primary_key:["threadId"]}],[{name:"workrooms_co_presence_states",id:246,primary_key:["userId"],indexes:{userCoPresence:["userId","coPresenceObjectId"]}}],[{name:"persistent_menu_ctas",id:251,primary_key:["threadKey","ctaId"]}],[{name:"workroom_creation_requests",id:252,primary_key:["creationId"]}],[{name:"pake_messages",id:258,primary_key:["sessionId"]}],[{name:"workroom_invites",id:257,primary_key:["inviteId"]}],[{name:"work_genai",id:293,primary_key:["threadKey","messageId"]}],[{name:"local_message_persistence_store",id:301,primary_key:["pk"],auto_increment:!0},{name:"local_message_persistence_store_supplemental",id:302,primary_key:["pk"],auto_increment:!0},{name:"local_message_persistence_store_deleted_messages",id:303,primary_key:["pk"],auto_increment:!0},{name:"local_message_persistence_store_tag_index",id:304,primary_key:["pk"],auto_increment:!0}],[{name:"secure_acs_configurations",id:307,primary_key:["configId"]},{name:"secure_acs_blinded_tokens",id:308,primary_key:["tokenId"],auto_increment:!0},{name:"secure_acs_tokens",id:309,primary_key:["tokenId"]},{name:"acs_request_context",id:310,primary_key:["taskId"]},{name:"anonymous_task_context",id:311,primary_key:["taskId"]}],[{name:"lightspeed_task_context",id:306,primary_key:["taskId"]}],[{name:"ohai_gateway_key_configs",id:313,primary_key:["keyId"]}],[{name:"client_xmas",id:314,primary_key:["pk"]}]]}),null);
__d("ReStoreDefaultValuesMetadata",["FBLogger"],(function(a,b,c,d,e,f,g){"use strict";function a(a){var b={c:"string",t:"string"};for(var d in b){if(!Object.prototype.hasOwnProperty.call(a,d)||a[d]==null){c("FBLogger")("messenger_web_product").warn('Malformed default values data, missing key "%s"',d);return null}var e=a[d],f=b[d];e=typeof e;if(e!==f){c("FBLogger")("messenger_web_product").warn('Malformed default values data, key "%s" has type "%s" but expected "%s"',d,e,f);return null}}if(typeof a.c!=="string"||typeof a.t!=="string")return null;e=[];f=a.t;try{e=JSON.parse(a.c);for(d=0;d<e.length;d++){b=e[d];if(typeof b!=="string")return null}}catch(a){return null}return{columns:e,tableName:f}}function b(a){return{c:JSON.stringify(a.columns),t:a.tableName}}d="_db_defaults_meta";e="_db_schema_meta";g.tryParseDefaultValuesData=a;g.defaultValuesColumnToValue=b;g.defaultValuesTableName=d;g.schemaVersionTableName=e}),98);
__d("ReStoreIndexMetadata",["FBLogger"],(function(a,b,c,d,e,f,g){"use strict";function h(a){a=typeof a==="string"?a:null;if(a==null)return null;try{a=JSON.parse(a);for(var b=a,c=Array.isArray(b),d=0,b=c?b:b[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var e;if(c){if(d>=b.length)break;e=b[d++]}else{d=b.next();if(d.done)break;e=d.value}e=e;if(typeof e!=="string")return null}return a}catch(a){return null}}function a(a){var b={indexName:"string",keyIds:"string",tableName:"string"};for(var d in b){if(!Object.prototype.hasOwnProperty.call(a,d)||a[d]==null){c("FBLogger")("messenger_web_product").warn('Malformed index data, missing key "%s"',d);return null}var e=a[d],f=b[d];e=typeof e;if(e!==f){c("FBLogger")("messenger_web_product").warn('Malformed index data, key "%s" has type "%s" but expected "%s"',d,e,f);return null}}e=h(a.keyIds);if(e==null){c("FBLogger")("messenger_web_product").warn('Malformed index data, key IDs "%s" are invalid',typeof a.keyIds==="string"?a.keyIds:"<"+typeof a.keyIds+">");return null}return typeof a.indexName!=="string"||typeof a.tableName!=="string"?null:{data:e,indexName:a.indexName,tableName:a.tableName}}function b(a,b){if(a==null)return!0;if(a.length!==b.length)return!0;for(var c=0;c<a.length;c++)if(a[c]!==b[c])return!0;return!1}function d(a){return{indexName:a.indexName,keyIds:JSON.stringify(a.data),tableName:a.tableName}}e="_db_indices_meta";g.tryParseIndexData=a;g.indicesDiffer=b;g.indexDataToValue=d;g.indicesTableName=e}),98);
__d("ReStoreMetadata",["ReStoreDefaultValuesMetadata","ReStoreIndexMetadata"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return function(b){var c={},e={},f=-1;for(var g=0;g<b.length;g++){var h=b[g];for(var h=h,i=Array.isArray(h),j=0,h=i?h:h[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]();;){var k,l;if(i){if(j>=h.length)break;l=h[j++]}else{j=h.next();if(j.done)break;l=j.value}l=l;k={autoIncrement:(k=l.auto_increment)!=null?k:!1,cascadeUpdates:(k=a[l.name])!=null?k:[],id:parseInt(l.id,10),indexes:(k=l.indexes)!=null?k:{},name:l.name,primaryKeyIds:l.primary_key};c[k.id]=k;e[k.name]=k;k.id>f&&(f=k.id)}}l={autoIncrement:!1,cascadeUpdates:[],id:++f,indexes:{},name:d("ReStoreIndexMetadata").indicesTableName,primaryKeyIds:["tableName","indexName"]};c[l.id]=l;e[l.name]=l;k={autoIncrement:!1,cascadeUpdates:[],id:++f,indexes:{},name:d("ReStoreDefaultValuesMetadata").defaultValuesTableName,primaryKeyIds:["t"]};c[k.id]=k;e[k.name]=k;j={autoIncrement:!1,cascadeUpdates:[],id:++f,indexes:{},name:d("ReStoreDefaultValuesMetadata").schemaVersionTableName,primaryKeyIds:[]};c[j.id]=j;e[j.name]=j;return{tableIds:c,tableNames:e}}}g.getBuildTableData=a}),98);
__d("LSMetadata",["LSDbForeignKeys","LSDbSchema","LSTableSchemas","ReStoreMetadata"],(function(a,b,c,d,e,f,g){"use strict";var h=d("ReStoreMetadata").getBuildTableData(c("LSDbForeignKeys"));function a(a){var b=a.flat().reduce(function(a,b){return Math.max(a,parseInt(b.id,10))},-1);a=h([].concat(a,[d("LSDbSchema").clientSchema.map(function(a,c){return babelHelpers["extends"]({},a,{id:(b+c+1).toString()})})]));var c=a.tableIds;a=a.tableNames;return{tableIds:c,tableNames:a}}b=a(c("LSTableSchemas"));g.buildTableData=h;g.buildMetadata=a;g.metadata=b}),98);
__d("IntervalList",["FBLogger","ReQLBounds","ReStoreKeyComparer"],(function(a,b,c,d,e,f,g){"use strict";var h,i;function j(a){if(a==null)throw c("FBLogger")("messenger_web_product").mustfixThrow("must not be null");return a}function a(a,b){var c=new Map(),e=new Map(),f=new Map();function g(b,c){return c==null?!0:(c.gt!==void 0?a(b,c.gt)>0:c.gte!==void 0?a(b,c.gte)>=0:!0)&&(c.lt!==void 0?a(b,c.lt)<0:c.lte!==void 0?a(b,c.lte)<=0:!0)}function* k(a){var f=0;while(f<a.length&&e.size){f++;var i=a.slice(0,f);f<b&&i.push((h||(h=d("ReStoreKeyComparer"))).MAX_KEY);i=e.get(JSON.stringify(i));if(i!=null)for(i of i)yield i}for(i of c.entries()){f=i[0];var j=i[1];c.has(f)&&g(a,j)&&(yield f)}}function l(a){var b=f.get(a);if(b!=null){f["delete"](a);var d=j(e.get(b));d["delete"](a);d.size===0&&e["delete"](b)}else c["delete"](a)}function m(a,g){var h;if(a&&a.gte!=null&&a.lte!=null&&(h=JSON.stringify((i||(i=d("ReQLBounds"))).nextKey(a.gte,b)))===JSON.stringify(a.lte)){var j=e.get(h);j==null&&(j=new Set(),e.set(h,j));j.add(g);f.set(g,h)}else c.set(g,a)}return{"delete":l,findIntersecting:k,set:m}}g["default"]=a}),98);
__d("I64MigrationHelper",["I64","nullthrows"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){return c("nullthrows")((h||(h=d("I64"))).cast(a))}g.cast=a}),98);
__d("LSTableDefaults",["I64MigrationHelper"],(function(a,b,c,d,e,f){e.exports={sync_groups:{syncStatus:(a=b("I64MigrationHelper")).cast([0,0]),sendSyncParams:!1,minTimeToSyncTimestampMs:a.cast([0,0]),canIgnoreTimestamp:!1,priority:a.cast([0,0]),lastSyncRequestTimestampMs:a.cast([0,0]),lastSyncCompletedTimestampMs:a.cast([0,0]),syncChannel:a.cast([0,1])},pending_tasks:{enqueueTimestampMs:a.cast([0,0]),firstExecutedTimestampMs:a.cast([0,0]),failureCount:a.cast([0,0]),minTimeToSyncTimestampMs:a.cast([0,0]),pluginType:a.cast([0,0]),priority:a.cast([0,0]),taskDispatchPriority:a.cast([0,0])},pending_fire_and_forget_tasks:{enqueueTimestampMs:a.cast([0,0]),priority:a.cast([0,0])},contacts:{isMessengerUser:!1,isMemorialized:!1,blockedByViewerStatus:a.cast([0,0]),rank:a.cast([0,0]),contactType:a.cast([0,0]),contactTypeExact:a.cast([0,0]),canViewerMessage:!0,gender:a.cast([0,0]),authorityLevel:a.cast([0,0]),optimisticBlockedByViewerStatus:a.cast([0,0]),optimisticBlockedByViewerStatusTimestampMs:a.cast([0,0]),contactReachabilityStatusType:a.cast([0,0]),restrictionType:a.cast([0,0]),waConnectStatus:a.cast([0,0]),capabilities2:a.cast([0,0]),isEmployee:!1},ig_contact_info:{e2eeEligibility:a.cast([0,0])},bot_profile_info_v2:{hasEmbodiment:!1},reactions:{timestampMs:a.cast([0,0]),authorityLevel:a.cast([0,0]),reactionCreationTimestampMs:a.cast([0,0])},threads:{lastActivityTimestampMs:a.cast([0,0]),lastReadWatermarkTimestampMs:a.cast([0,0]),removeWatermarkTimestampMs:a.cast([0,0]),muteExpireTimeMs:a.cast([0,0]),isAdminSnippet:!1,ongoingCallState:a.cast([0,0]),snippetHasEmoji:!1,hasPersistentMenu:!1,disableComposerInput:!1,capabilities:a.cast([0,0]),isCustomThreadPicture:!1,isDisappearingMode:!1,unreadDisappearingMessageCount:a.cast([0,0]),authorityLevel:a.cast([0,0]),capabilities2:a.cast([0,0]),muteCallsExpireTimeMs:a.cast([0,0]),unsendLimitMs:a.cast([0,0]),threadInvitesEnabled:a.cast([0,0]),threadInvitesEnabledV2:a.cast([0,0]),capabilities3:a.cast([0,0]),muteMentionExpireTimeMs:a.cast([0,0]),isReadReceiptsDisabled:!1,readReceiptsDisabledV2:a.cast([0,0]),capabilities4:a.cast([0,0]),isHidden:!1},threads_ranges_v2__generated:{minThreadKey:a.cast([0,0]),minLastActivityTimestampMs:a.cast([0,0]),maxThreadKey:a.cast([0,0]),maxLastActivityTimestampMs:a.cast([0,0]),isLoadingBefore:!1,isLoadingAfter:!1,hasMoreBefore:!1,hasMoreAfter:!1},messages:{timestampMs:a.cast([0,0]),primarySortKey:a.cast([0,0]),secondarySortKey:a.cast([0,0]),isAdminMessage:!1,sendStatus:a.cast([0,0]),sendStatusV2:a.cast([0,0]),isUnsent:!1,replyStatus:a.cast([0,0]),replyAttachmentType:a.cast([0,0]),hasQuickReplies:!1,textHasLinks:!1,viewFlags:a.cast([0,0]),displayedContentTypes:a.cast([0,1]),quickReplyType:a.cast([0,0]),authorityLevel:a.cast([0,0]),unsentTimestampMs:a.cast([0,0]),isCollapsed:!1,messageRenderingType:a.cast([0,0])},messages_ranges_v2__generated:{isLoadingBefore:!1,isLoadingAfter:!1,hasMoreBefore:!1,hasMoreAfter:!1},participants:{readWatermarkTimestampMs:a.cast([0,0]),deliveredWatermarkTimestampMs:a.cast([0,0]),authorityLevel:a.cast([0,0]),readActionTimestampMs:a.cast([0,0]),groupParticipantJoinState:a.cast([0,0]),threadRoles:a.cast([0,0])},attachments:{timestampMs:a.cast([0,0]),attachmentType:a.cast([0,0]),hasMedia:!1,isSharable:!1,hasXma:!1,attachmentIndex:a.cast([0,0]),authorityLevel:a.cast([0,0])},attachments_ranges_v2__generated:{mediaGroup:a.cast([0,0]),isLoadingBefore:!1,isLoadingAfter:!1,hasMoreBefore:!1,hasMoreAfter:!1},attachment_items:{attachmentIndex:a.cast([0,0])},group_membership_approval_requests:{authorityLevel:a.cast([0,0])},admin_message_ctas:{timestampMs:a.cast([0,0]),showAdChoiceIcon:!1},thread_nullstate:{ctaType:a.cast([0,0]),privacyTextCtaType:a.cast([0,0])},messages_status:{timestampMs:a.cast([0,0])},polls:{pollType:a.cast([0,0])},poll_options_v2:{voteCount:a.cast([0,0]),sortKeyVotingTimestamp:a.cast([0,0]),sortKeyCreationTimestamp:a.cast([0,0])},filtered_threads_ranges_v3__generated:{minThreadKey:a.cast([0,0]),minLastActivityTimestampMs:a.cast([0,0]),maxThreadKey:a.cast([0,0]),maxLastActivityTimestampMs:a.cast([0,0]),isLoadingBefore:!1,isLoadingAfter:!1,hasMoreBefore:!1,hasMoreAfter:!1,folderName:"inbox",secondaryThreadRangeFilter:a.cast([0,0]),threadRangeFilterValue:""},community_folders:{capabilities:a.cast([0,0]),notificationMutedUntil:a.cast([0,0]),inviteStatus:a.cast([0,0]),capabilities2:a.cast([0,0]),capabilities3:a.cast([0,0])},community_members:{source:a.cast([0,0]),adminActions:a.cast([0,0]),contactCapabilities:a.cast([0,0]),channelBadges:a.cast([0,0]),threadRoles:a.cast([0,0]),requestId:""},ig_thread_info:{igDmSettingsMode:a.cast([0,0]),igDmSettingsTtlSec:a.cast([-1,4294967295])},inbox_threads_ranges:{minThreadKey:a.cast([0,0]),minLastActivityTimestampMs:a.cast([0,0]),isLoadingBefore:!1,hasMoreBefore:!1},community_direct_invites_presets:{fallbackUrl:"",pictureUrlExpirationTimestampMs1:a.cast([0,0]),pictureUrlExpirationTimestampMs2:a.cast([0,0]),presetTypeV2:"ALL_MEMBERS"},sync_group_threads_ranges:{minThreadKey:a.cast([0,0]),minLastActivityTimestampMs:a.cast([0,0]),isLoadingBefore:!1,hasMoreBefore:!1},community_chat_polls:{pollType:a.cast([0,0])},community_chat_poll_options:{voteCount:a.cast([0,0]),sortKeyVotingTimestamp:a.cast([0,0]),sortKeyCreationTimestamp:a.cast([0,0])},reactions_v2:{viewerReactionTimestampMs:a.cast([0,0]),lastUpdatedTimestampMs:a.cast([0,0])},group_invitations_pending:{communityJoinRequestStatus:a.cast([0,0]),communityParticipationControlRequestStatus:a.cast([0,0]),communityParticipationControlSetting:a.cast([0,0])},thread_label_mappings:{sortKey:a.cast([0,0])},inbox_view_state:{value:""},inbox_view_state_v2:{value:""},discoverable_chat_participants:{source:a.cast([0,0])},roll_calls:{viewerHasContributed:!1,viewerCanEditPrompt:!1,isBlurred:!1,canViewWithoutContributing:!1},roll_call_contributions_v2:{contributorId:a.cast([0,0]),contributionSource:a.cast([0,0])},shared_albums:{lastActivityTimestampMs:a.cast([0,0]),contributionCount:a.cast([0,0])},shared_album_contributions:{creationTimestampMs:a.cast([0,0]),creatorId:a.cast([0,0])},search_queries:{surfaceType:a.cast([0,1])},universal_search_recent_searches:{lastAccessedTimestampMs:a.cast([0,0])},cm_search_nullstate_metadata:{score:0},ai_bot_search_metadata:{displayName:"",contactViewerRelationship:a.cast([0,0]),score:0},contact_upload_settings:{authorityLevel:a.cast([0,0])},presence_settings:{isActiveStatusViewable:!1,isActiveStatusViewableOnFb:!1,isActiveStatusViewableOnMessenger:!1,hasConvertedToViewSideSettings:!1},video_chat_links_joining:{canAnonymousUsersJoin:a.cast([0,0])},notification_settings:{includeInSwitchAccountBadges:!1,mutePageAccountMessageReminder:!1},avatar_settings:{enableAvatarHotlike:!1},messaging_privacy_settings:{readReceiptsDisabled:a.cast([0,0])},rtc_call_events:{isProcessed:!1},custom_thread_commands:{isOpenPersistentMenu:!1},transaction_history:{timestampMs:a.cast([0,0])},thread_themes:{isDeprecated:!1,iconUrl:"",iconUrlFallback:"",backgroundUrl:""},ranking_scores:{score:a.cast([0,0]),scoreIndex:a.cast([0,0])},story_buckets:{pageNum:a.cast([0,0]),readState:a.cast([0,0])},stories:{authorityLevel:a.cast([0,0])},story_viewers:{interactionType:a.cast([0,1]),authorityLevel:a.cast([0,0])},story_reactions:{authorityLevel:a.cast([0,0])},story_ad_unit:{shouldShowAdChoice:!1},story_overlays:{authorityLevel:a.cast([0,0])},rooms:{notificationMutedUntilMs:a.cast([0,0])},media_staging:{progress:a.cast([0,0])},client_messages:{textSize:a.cast([0,0]),sendStatus:a.cast([0,0]),isHidden:!1,isTombstoned:!1,isReplyOnly:!1,messageContentType:a.cast([0,0]),messageContentSubtype:a.cast([0,0]),messageSource:a.cast([0,0]),messageCreationType:a.cast([0,0]),messageEphemeralityType:a.cast([0,0]),replyStatus:a.cast([0,0]),replyMessageTextSize:a.cast([0,0]),replyVicinityStatus:a.cast([0,0]),isForwarded:!1,isReadonly:!1,disabledActionsReason:a.cast([0,0]),shouldPersist:!1,shouldHideInSnippet:!1},client_participants:{isPending:!1,capabilities1:a.cast([0,0]),capabilities2:a.cast([0,0]),readActionTsMs:a.cast([0,0])},client_threads:{isAdminSnippet:!1,isHotlikeSnippet:!1,groupMemberAddMode:a.cast([0,0]),capabilities1:a.cast([0,0]),capabilities2:a.cast([0,0]),isHidden:!1,isTombstoned:!1,isPending:!1,isShadowThread:!1,pinnedMessagesCount:a.cast([0,0])},data_trace_meta:{initTimestampMs:a.cast([0,0]),foregroundTimestampMs:a.cast([0,0]),traceType:a.cast([0,0]),shouldFlush:!1},data_trace_addon:{timestampMs:a.cast([0,0])},secure_encrypted_backups_client_state:{authorityLevel:a.cast([0,0]),encryptionVersion:a.cast([0,0]),revisionVersion:a.cast([0,0])},secure_encrypted_backups_epochs:{authorityLevel:a.cast([0,0])},encrypted_backups:{authorityLevel:a.cast([0,0]),hasOtcEligibleDevices:!1},secure_encrypted_backups_generated_recovery_code:{virtualDeviceType:a.cast([0,1])},encrypted_backups_virtual_devices:{virtualDeviceType:a.cast([0,1]),removalStatus:a.cast([0,1]),requiresHsmMigration:!1},encrypted_backups_metadata:{authorityLevel:a.cast([0,0])},cutover_threads:{isMigrated:!1,showOpenMessageHistory:!1},persistent_menu_ctas:{ctaType:"fallback"},lightspeed_task_context:{requiresAuthentication:!1}}}),null);
__d("ReStoreUtils",["LSTableDefaults","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function a(a){return h.apply(this,arguments)}function h(){h=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){var b=[],c=(yield a.next());while(!c.done)b.push(c.value),c=(yield a.next());return b});return h.apply(this,arguments)}function d(a,b){var d=c("LSTableDefaults")[b];return!d?a:Object.keys(d).reduce(function(a,b){Object.prototype.hasOwnProperty.call(a,b)||(a[b]=d[b]);return a},babelHelpers["extends"]({},a))}g.collectIterator=a;g.appendDefaultValues=d}),98);
__d("ReStoreDefaultValueMigration",["LSPlatformLsInitLog","LSTableDefaults","ReStoreDefaultValuesMetadata","ReStoreUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c={};b=(yield d("ReStoreUtils").collectIterator(b.table(d("ReStoreDefaultValuesMetadata").defaultValuesTableName).entries(a)));for(a of b){b=a[0];var e=a[1];if(b!=null){var f;b=d("ReStoreDefaultValuesMetadata").tryParseDefaultValuesData(e);if(b==null)continue;e=b.columns;b=b.tableName;c[b]=(f=c[b])!=null?f:new Set();for(f of e)c[b].add(f)}}return c});return i.apply(this,arguments)}function j(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,d){a=(yield h(a,b));b={};for(d in d.tableNames){var e=c("LSTableDefaults")[d];if(e!=null)for(var f in e){var g;g=(g=a[d])==null?void 0:g.has(f);if(!g){b[d]=(g=b[d])!=null?g:{};b[d][f]=e[f]}}}return b});return k.apply(this,arguments)}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){for(b in b){var e=Object.keys(c("LSTableDefaults")[b]||{});e={columns:e,tableName:b};yield a.table(d("ReStoreDefaultValuesMetadata").defaultValuesTableName).put(d("ReStoreDefaultValuesMetadata").defaultValuesColumnToValue(e))}});return m.apply(this,arguments)}function a(a,b){return n.apply(this,arguments)}function n(){n=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c=new WeakMap();d("LSPlatformLsInitLog").addPoint("default_values_update_start");var e=function(a,b){d("LSPlatformLsInitLog").addPoint("default_values_update_end_failure",{string:{default_values_update_failure_point:b,default_values_update_failure_reason:String(a)}})};try{b=(yield j(c,a,b));try{for(var f in b){var g=a.table(f).entries(c),h=(yield g.next());while(!h.done){var i=babelHelpers["extends"]({},h.value[1]);i=d("ReStoreUtils").appendDefaultValues(i,f);yield a.table(f).put(i);h=(yield g.next())}}yield l(a,b);d("LSPlatformLsInitLog").addPoint("default_values_update_end")}catch(a){e(a,"setDefaultValues")}}catch(a){e(a,"findDefaultValuesToUpdate")}});return n.apply(this,arguments)}g.runMigrationForTableDefaultValuesIfNeeded=a}),98);
__d("ReStoreHooks",["PromiseOrValue"],(function(a,b,c,d,e,f,g){"use strict";var h;function a(a){return{afterEntriesNext:a.reduce(function(a,b){var c=b.onAfterEntriesNext;return c?function(b){return c({tableName:b.tableName,value:a(b)})}:a},function(a){a=a.value;return a}),afterGet:a.reduce(function(a,b){var c=b.onAfterGet;return c?function(b){return c({tableName:b.tableName,value:a(b)})}:a},function(a){a=a.value;return a}),beforeAdd:a.reduce(function(a,b){var c=b.onBeforeAdd;return c?function(b){return(h||(h=d("PromiseOrValue"))).map(a(b),function(a){return c(babelHelpers["extends"]({},b,{value:a}))})}:a},function(a){a=a.value;return a}),beforeDeleteThenInsert:a.reduce(function(a,b){var c=b.onBeforeDeleteThenInsert;return c?function(b){return(h||(h=d("PromiseOrValue"))).map(a(b),function(a){return c(babelHelpers["extends"]({},b,{value:a}))})}:a},function(a){a=a.value;return a}),beforeNotify:a.reduce(function(a,b){var c=b.onBeforeNotify;return c?function(b){var d=a(b),e=d.newValue;d=d.prevValue;return c({newValue:e,prevValue:d,tableName:b.tableName})}:a},function(a){var b=a.newValue;a=a.prevValue;return{newValue:b,prevValue:a}}),beforePut:a.reduce(function(a,b){var c=b.onBeforePut;return c?function(b){return(h||(h=d("PromiseOrValue"))).map(a(b),function(a){return c(babelHelpers["extends"]({},b,{value:a}))})}:a},function(a){a=a.value;return a}),beforeUpsert:a.reduce(function(a,b){var c=b.onBeforeUpsert;return c?function(b){return(h||(h=d("PromiseOrValue"))).map(a(b),function(a){return c(babelHelpers["extends"]({},b,{value:a}))})}:a},function(a){a=a.value;return a})}}g.createHookManager=a}),98);
__d("ReStoreIndicesMigration",["LSPlatformLsInitLog","ReStoreIndexMetadata","ReStoreUtils","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";function h(a,b){return i.apply(this,arguments)}function i(){i=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){var c={};b=(yield d("ReStoreUtils").collectIterator(b.table(d("ReStoreIndexMetadata").indicesTableName).entries(a)));for(a of b){b=a[0];var e=a[1];if(b!=null){var f;e=d("ReStoreIndexMetadata").tryParseIndexData(e);if(e==null)continue;var g=e.indexName,h=e.tableName;c[h]=(f=c[h])!=null?f:{};c[h][g]={index:e.data,key:b}}}return c});return i.apply(this,arguments)}function j(a,b,c){return k.apply(this,arguments)}function k(){k=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c){a=(yield h(a,b));b={};for(var e in c.tableNames){var f=c.tableNames[e];for(var g in f.indexes){var i,j=f.indexes[g];i=(i=a[e])==null?void 0:i[g];if(d("ReStoreIndexMetadata").indicesDiffer(i==null?void 0:i.index,j)){b[e]=(i=b[e])!=null?i:{};b[e][g]=j}}}i={};for(j in a){g=a[j];for(f in g){var k;e=g[f];k=(k=c.tableNames[j])==null?void 0:(k=k.indexes)==null?void 0:k[f];if(k==null){i[j]=(k=i[j])!=null?k:{};i[j][f]=e}}}return{toRemove:i,toUpdate:b}});return k.apply(this,arguments)}function l(a,b){return m.apply(this,arguments)}function m(){m=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){for(var c in b){var e=b[c];for(var f in e){var g=e[f];g={data:g,indexName:f,tableName:c};yield a.table(d("ReStoreIndexMetadata").indicesTableName).put(d("ReStoreIndexMetadata").indexDataToValue(g))}}});return m.apply(this,arguments)}function n(a,b){return o.apply(this,arguments)}function o(){o=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b){for(var c in b){var e=b[c];for(var f in e){var g,h=e[f].key;yield (g=a.table(d("ReStoreIndexMetadata").indicesTableName))["delete"].apply(g,h)}}});return o.apply(this,arguments)}function a(a,c,e){var f=new WeakMap();d("LSPlatformLsInitLog").addPoint("index_migration_start");var g=function(a,b){d("LSPlatformLsInitLog").addPoint("index_migration_end_failure",{string:{index_migration_failure_point:b,index_migration_failure_reason:String(a)}})};return j(f,a,c).then(function(){var f=b("asyncToGeneratorRuntime").asyncToGenerator(function*(b){var f=b.toRemove;b=b.toUpdate;var g=Array.from(new Set([].concat(Object.keys(b),Object.keys(f))));d("LSPlatformLsInitLog").addAnnotations({"int":{index_migration_rebuild_tables_count:g.length},string_array:{index_migration_rebuilt_tables:g}});for(g of g)if(c.tableNames[g]!=null){var h;h=Array.from(new Set([].concat(Object.keys((h=b[g])!=null?h:{}),Object.keys((h=f[g])!=null?h:{}))));yield e(g,h)}yield l(a,b);yield n(a,f);d("LSPlatformLsInitLog").addPoint("index_migration_end")});return function(a){return f.apply(this,arguments)}}(),function(a){return g(a,"findIndicesToUpdateOrRemove")})["catch"](function(a){return g(a,"rebuildIndices")})}g.runMigrationForIndicesIfNeeded=a}),98);
__d("ReStorePersistenceIds",[],(function(a,b,c,d,e,f){"use strict";a="nextId";b="seed";c="schema_version";d="default_value_version";f.idForNextId=a;f.idForSeed=b;f.idForSchema=c;f.idForDefaultValue=d}),66);
__d("ReStorePersistence",["FBLogger","ReStoreKeyComparer","ReStorePersistenceIds","asyncToGeneratorRuntime","isPromise","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j={},k={gt:[!1,0],gte:[!0,0],lt:[!0,1],lte:[!1,1]},l=new Set(["encrypted_backups_virtual_devices","secure_encrypted_backups_recovery_code_status","device_metadata","secure_encrypted_backups_epochs","secure_encrypted_backups_client_state","encrypted_backups","experiences_shared_state","occamadillo_most_recent_message_per_thread"]),m=16;function n(a,b,c){return(a.has(b)?a:a.set(b,c())).get(b)}function o(b){if(b==null)return b;var c=Object.getOwnPropertyNames(b),a={},d,e;for(d=0;d<c.length;d++)e=b[c[d]],a[c[d]]=e;return a}function p(a,b){b===void 0&&(b=j);return a===b}function q(a,b,c){var e=0,f=a.length-1;while(e<=f){var g=e+f>>1;(c[0]?(i||(i=d("ReStoreKeyComparer"))).compareKey(a[g],b)<0:(i||(i=d("ReStoreKeyComparer"))).compareKey(a[g],b)<=0)?e=g+1:f=g-1}g=[e,f][c[1]];return g===a.length?-1:g}var r=function(){function a(a,b,c,d,e){this.$2=b,this.$3=c,this.$1=a,this.$4=d,this.$5=e}var b=a.prototype;b.$6=function(a){return a==null?"root":"index("+a+")"};b.$7=function(a,b){return n(this.$1,b,function(){return{children:[].concat(a.children),isLeaf:!0,keys:[].concat(a.keys),nextId:a.nextId,prevId:a.prevId}})};b.$8=function(a,b){return n(this.$1,b,function(){return{children:[].concat(a.children),isLeaf:!1,keys:[].concat(a.keys)}})};b.$9=function(a,b){return n(this.$1,b,function(){return{headId:a.headId,rootId:a.rootId,tailId:a.tailId}})};b.$10=function(a,b){if(!a.length){a.push(b);return[0,0]}var c=q(a,b,k.gte);if(c===-1)return[a.push(b)-1,0];else if((i||(i=d("ReStoreKeyComparer"))).compareKey(a[c],b)===0)return[c,1];a.splice(c,0,b);return[c,0]};b.$11=function*(a,b,c,d){var e=(yield* this.$12(a,b));e=e;b=b;var f=-1;while(!e.isLeaf)d==null?void 0:d.push([e,b,f]),f=q(e.keys,c,k.gt),f===-1&&(f=e.keys.length),b=e.children[f],e=(yield* this.$12(a,b));return[e,b,f]};b.$13=function*(a,b){this.$3();var d=this.$1.get(b);if(p(d))return void 0;if(d!==void 0)return d;d=this.$4.get(a,this.$2,b,this.$5);return(h||(h=c("isPromise")))(d)?yield d:d};b.$12=function*(a,b){a=(yield* this.$13(a,b));if(a===void 0){var d=this.$1.get(b);this.$4.logError==null?void 0:this.$4.logError(this.$2,this.$5,"dbCorruption",{deletedInThisTxn:p(d)?"true":"false",id:JSON.stringify(b)||""});throw c("unrecoverableViolation")("value not found","messenger_web_product")}return a};b.$14=function*(a,b){a=(a=(yield* this.$13(a,d("ReStorePersistenceIds").idForNextId)))!=null?a:0;this.$1.set("nextId",a+1);this.$1.set(a,b);return a};b.$15=function(a,b){this.$3(),this.$1.set(a,b)};b.incrementSeed=function*(a,b){a=(a=(yield* this.$13(a,"seed")))!=null?a:0;this.$1.set("seed",Math.max(a,b||0)+1);return b===void 0?a:b};b.readData=function*(a,b){return yield* this.$13(a,b)};b.readDataExn=function*(a,b){return yield* this.$12(a,b)};b.readId=function*(a,b,c){b=(yield* this.$13(a,this.$6(b)));if(b==null)return;a=(yield* this.$11(a,b.rootId,c));b=a[0];a=q(b.keys,c,k.gte);if(a===-1||(i||(i=d("ReStoreKeyComparer"))).compareKey(b.keys[a],c)!==0)return;return b.children[a]};b.writeId=function*(a,b,c,d){b=this.$6(b);var e=(yield* this.$13(a,b));if(e==null){var f={children:[d],isLeaf:!0,keys:[c]};f=(yield* this.$14(a,f));this.$15(b,{headId:f,rootId:f,tailId:f});return}f=[];var g=(yield* this.$11(a,e.rootId,c,f)),h=g[0];g=g[1];h=this.$7(h,g);c=this.$10(h.keys,c);var i=c[0];c=c[1];h.children.splice(i,c,d);i=h;c=g;for(;i.keys.length>=m;i=h,c=d){h=(d=f.pop())!=null?d:[];g=h[0];d=h[1];d!=null?h=this.$8(g,d):(h={children:[c],isLeaf:!1,keys:[]},this.$9(e,b).rootId=(yield* this.$14(a,h)));g=Math.floor(i.keys.length/2);var j=void 0;if(i.isLeaf){var k={children:i.children.slice(g),isLeaf:!0,keys:i.keys.slice(g),nextId:i.nextId,prevId:c},l=j=i.nextId=(yield* this.$14(a,k));k=k.nextId;k?this.$7(yield* this.$12(a,k),k).prevId=l:this.$9(e,b).tailId=j}else j=(yield* this.$14(a,{children:i.children.slice(g+1),isLeaf:!1,keys:i.keys.slice(g+1)}));k=this.$10(h.keys,i.keys[g]);l=k[0];h.children.splice(l+1,0,j);i.keys.length=g;i.children.length=g+(i.isLeaf?0:1)}};b.removeId=function*(a,b,e){b=this.$6(b);var f=(yield* this.$13(a,b));if(f==null)return!1;var g=Math.floor(m/2),h=[],n=(yield* this.$11(a,f.rootId,e,h)),o=n[0],p=n[1];n=n[2];var r=this.$7(o,p),s=q(o.keys,e,k.gte);if(s===-1||(i||(i=d("ReStoreKeyComparer"))).compareKey(o.keys[s],e)!==0)return!1;r.keys.splice(s,1);r.children.splice(s,1);o=r;e=p;s=n;for(;o.keys.length<g&&h.length;t=[p,n,r],o=t[0],e=t[1],s=t[2],t){r=h.pop();p=r[0];n=r[1];r=r[2];p=this.$8(p,n);var t=[[{nodeId:p.children[s-1]},{node:o,nodeId:e},s-1],[{node:o,nodeId:e},{nodeId:p.children[s+1]},s]].filter(function(b){var a=b[0];b=b[1];return a.nodeId!==void 0&&b.nodeId!==void 0});for(var u of t){var v=u[0],w=u[1],x=u[2],y=v.node=v.node||(yield* this.$12(a,v.nodeId)),z=w.node=w.node||(yield* this.$12(a,w.nodeId));if(y.keys.length+w.node.keys.length>=g*2){if(o.isLeaf){var A=this.$7(y,v.nodeId),B=this.$7(z,w.nodeId),C=[].concat(A.children,B.children),D=[].concat(y.keys,z.keys);A.children=(B.children=C).splice(0,g);A.keys=(B.keys=D).splice(0,g);p.keys[x]=D[0]}else{C=this.$8(y,v.nodeId);A=this.$8(z,w.nodeId);B=[].concat(C.children,A.children);D=[].concat(C.keys,[p.keys[x]],A.keys);C.children=(A.children=B).splice(0,g+1);p.keys[x]=D.splice(g,1)[0];C.keys=(A.keys=D).splice(0,g)}return!0}}for(y of t){v=y[0];z=y[1];w=y[2];if(o.isLeaf){B=this.$7(v.node,v.nodeId);x=this.$7(z.node,z.nodeId);B.children=[].concat(B.children,x.children);B.keys=[].concat(B.keys,x.keys);x.keys.length=0;C=x.nextId;if(C){A=this.$7(yield* this.$12(a,C),C);A.prevId=v.nodeId}else this.$9(f,b).tailId=v.nodeId;B.nextId=x.nextId}else{D=this.$8(v.node,v.nodeId);u=this.$8(z.node,z.nodeId);D.children=[].concat(D.children,u.children);D.keys=[].concat(D.keys,[p.keys[w]],u.keys)}p.keys.splice(w,1);p.children.splice(w+1,1);this.$1.set(z.nodeId,j);break}}C=(yield* this.$12(a,f.rootId));if(!C.keys.length&&C.children.length){if(C.isLeaf){l.has(this.$2)&&(this.$4.logError==null?void 0:this.$4.logError(this.$2,this.$5,"dbCorruption",{}));throw c("unrecoverableViolation")("cannot be leaf","messenger_web_product")}this.$1.set(f.rootId,j);this.$9(f,b).rootId=C.children[0]}return!0};b.idEntries=function(a,b,e){e=e===void 0?{}:e;var f=e.dir,g=f===void 0?"asc":f,h=babelHelpers.objectWithoutPropertiesLoose(e,["dir"]);function j(){if(g==="asc"){if(Object.prototype.hasOwnProperty.call(h,"gt"))return h.gt;else if(Object.prototype.hasOwnProperty.call(h,"gte"))return h.gte}else if(Object.prototype.hasOwnProperty.call(h,"lt"))return h.lt;else if(Object.prototype.hasOwnProperty.call(h,"lte"))return h.lte}function l(a){if(g==="asc")return Object.prototype.hasOwnProperty.call(h,"gt")?q(a.keys,h.gt,k.gt):Object.prototype.hasOwnProperty.call(h,"gte")?q(a.keys,h.gte,k.gte):0;else return Object.prototype.hasOwnProperty.call(h,"lt")?q(a.keys,h.lt,k.lt):Object.prototype.hasOwnProperty.call(h,"lte")?q(a.keys,h.lte,k.lte):a.keys.length-1}if(Object.prototype.hasOwnProperty.call(h,"gt")&&Object.prototype.hasOwnProperty.call(h,"gte"))throw c("unrecoverableViolation")("cannot specify both greater than and greater than or equal","messenger_web_product");if(Object.prototype.hasOwnProperty.call(h,"lt")&&Object.prototype.hasOwnProperty.call(h,"lte"))throw c("unrecoverableViolation")("cannot specify both less than and less than or equal","messenger_web_product");var m,n=this;return{next:function*(e){var f,o;if(m==null){var p=(yield* n.$13(a,n.$6(b)));if(p==null)return{done:!0};var r=j();if(r!==void 0){r=(yield* n.$11(a,p.rootId,r));f=r[0];r=r[1]}else if(g==="asc"){var s=[yield* n.$12(a,p.headId),p.headId];f=s[0];r=s[1]}else{s=[yield* n.$12(a,p.tailId),p.tailId];f=s[0];r=s[1]}p=l(f)}else{s=m;p=s.i;o=s.key;r=s.nodeId;f=(yield* n.$13(a,r));if(e!=null){if((i||(i=d("ReStoreKeyComparer"))).compareKey(e,o)===(g==="asc"?-1:1))throw c("unrecoverableViolation")("key must be ahead of current key","messenger_web_product");if(f==null||(i||(i=d("ReStoreKeyComparer"))).compareKey(e,f.keys[0])<0||(i||(i=d("ReStoreKeyComparer"))).compareKey(e,f.keys[f.keys.length-1])>0){s=(yield* n.$13(a,n.$6(b)));if(s==null)return{done:!0};s=(yield* n.$11(a,s.rootId,e));f=s[0];r=s[1]}p=q(f.keys,e,k[g==="asc"?"gte":"lte"])}else{if(f==null||p<0||p>=f.keys.length||(i||(i=d("ReStoreKeyComparer"))).compareKey(f.keys[p],o)!==0){if(f==null||!f.keys.length||(i||(i=d("ReStoreKeyComparer"))).compareKey(o,f.keys[0])<0||(i||(i=d("ReStoreKeyComparer"))).compareKey(o,f.keys[f.keys.length-1])>0){s=(yield* n.$13(a,n.$6(b)));if(s==null)return{done:!0};e=(yield* n.$11(a,s.rootId,o));f=e[0];r=e[1]}p=q(f.keys,o,k[g==="asc"?"lte":"gte"])}p+=g==="asc"?1:-1}}if(p<0||p>=f.keys.length)if(g==="asc"){if(f.nextId===void 0)return{done:!0};r=f.nextId;f=(yield* n.$12(a,r));p=0}else{if(f.prevId===void 0)return{done:!0};r=f.prevId;f=(yield* n.$12(a,r));p=f.keys.length-1}o=f.keys[p];m={i:p,key:o,node:f,nodeId:r};if(p<0||p>=f.keys.length)return{done:!0};s=g==="asc"?Object.prototype.hasOwnProperty.call(h,"lt")&&(i||(i=d("ReStoreKeyComparer"))).compareKey(o,h.lt)>=0||Object.prototype.hasOwnProperty.call(h,"lte")&&(i||(i=d("ReStoreKeyComparer"))).compareKey(o,h.lte)>0:Object.prototype.hasOwnProperty.call(h,"gt")&&(i||(i=d("ReStoreKeyComparer"))).compareKey(o,h.gt)<=0||Object.prototype.hasOwnProperty.call(h,"gte")&&(i||(i=d("ReStoreKeyComparer"))).compareKey(o,h.gte)<0;return s?{done:!0}:{done:!1,value:[f.keys[p],f.children[p]]}}}};b.clearIds=function*(a,b){this.$3();b=this.$6(b);var c=(yield* this.$13(a,b));this.$3();if(c==null)return;var d=(yield* this.$12(a,c.rootId));c=[{id:c.rootId,node:d}];while(c.length>0){d=c.shift();var e=d.id;d=d.node;if(!d.isLeaf)for(d of d.children){var f=(yield* this.$13(a,d));f!=null&&c.push({id:d,node:f})}this.$1.set(e,j)}this.$1.set(b,j)};b.readSeed=function*(a){return(a=(yield* this.$13(a,d("ReStorePersistenceIds").idForSeed)))!=null?a:0};b.remove=function(a,b){this.$3(),this.$1.set(b,j)};b.writeData=function(a,b,c){this.$15(b,o(c))};b.writeNewData=function*(a,b){return yield* this.$14(a,o(b))};return a}(),s=function(){function a(a,b,d){var e=this;this.$2=new Map();this.$6=!1;this.$3=function(){if(e.$6)throw c("FBLogger")("messenger_web_product").mustfixThrow("Transaction has closed");d()};this.$4=b;this.$1=a;this.$5={get:function(a,c,d){var f=n(e.$1,c,function(){return new Map()});f=f.get(d);if(p(f))return void 0;return f!==void 0?f:b.get(a,c,d,"readwrite")},logError:b.logError}}var b=a.prototype;b.flush=function(){for(var a of this.$2){var b=a[0],c=a[1];b=n(this.$1,b,function(){return new Map()});for(c of c){var d=c[0],e=c[1];b.set(d,e)}}this.$6=!0};b.table=function(a){return new r(n(this.$2,a,function(){return new Map()}),a,this.$3,this.$5,"readwrite")};return a}(),t=function(){function a(a,b){var d=this;this.$1=new Map();this.$2=!1;this.$5=function(){if(d.$2)throw c("FBLogger")("messenger_web_product").mustfixThrow("Transaction has closed")};this.$3=a;this.$4=b;this.types=a.types}var d=a.prototype;d.close=function(){this.$2=!0};d.flush=function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a===void 0&&(a={upgrade:!1}),yield this.$3.flush(this.$1,a),this.$2=!0});function c(b){return a.apply(this,arguments)}return c}();d.table=function(a){return new r(n(this.$1,a,function(){return new Map()}),a,this.$5,this.$3,this.$4)};d.createNested=function(){return new s(this.$1,this.$3,this.$5)};return a}();function a(a){var b;return{clearCache:a.clearCache,close:a.close,createTransaction:function(b){return new t(a,b)},isClosed:a.isClosed||function(){return!1},logError:a.logError,queueCommitWork:(b=a.queueCommitWork)!=null?b:function(a){return a()},runExclusively:a.runExclusively}}g.sentinelDeleted=j;g.isDeletedValue=p;g.createDbStore=a}),98);
__d("createReStoreSubscriptionManager",["ExecutionEnvironment","FBLogger","IntervalList","LSStorage","Promise","PromiseOrValue","ReStoreKeyComparer","asyncToGeneratorRuntime","gkx","isPromise","nullthrows","promiseDone"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l;function a(a,e,f){var g=new Map(),m=new Map();function n(a,b){return(l||(l=d("ReStoreKeyComparer"))).compareValue(a,b)===0}function o(a,b,c,d){a=(a=z.get(a))!=null?a:[];var e=[];for(var f=0;f<b.length;f++){var g=b[f];for(var h=0;h<32&&g!==0;h++){if(g&1){var i=a[(f<<5)+h];if(!n(c[i],d[i])){e[f]=((i=e[f])!=null?i:0)|1<<h%32}}g=g>>>1}}return e}function p(a,b){for(var c=0;c<Math.max(a.length,b.length);c++)if((a[c]&b[c])!==0)return!0;return!1}function q(a,b,d,e){if(c("gkx")("1583"))try{var f=a(b,d,e);if((j||(j=c("isPromise")))(f))return f["catch"](function(a){c("FBLogger")("messenger_web_product").catching(a).mustfix("error in ReStore subscription async handler")});else return f}catch(a){c("FBLogger")("messenger_web_product").catching(a).mustfix("error in ReStore subscription handlers")}else return a(b,d,e)}function r(a,c,e,f,g){var i=Array.from(c(f));if(g.operation==="put"&&g.prevValue!=null){c=function(){var b=g.prevValue,c=[];for(var h of i){h[0];var j=h[1];j!=null&&j.forEach(function(a,b){c[b]=((b=c[b])!=null?b:0)|a})}var l=o(a,c,b,g.value);return{v:(k||(k=d("PromiseOrValue"))).all(i.map(function(a){var b=a[0];a=a[1];if(a==null||p(l,a))return q(b,f,g,e)}))}}();if(typeof c==="object")return c.v}return(h||(h=b("Promise"))).all(i.map(function(a){var b=a[0];a[1];return q(b,f,g,e)}))}function s(b){return c("nullthrows")((g.has(b)?g:g.set(b,[c("IntervalList")((l||(l=d("ReStoreKeyComparer"))).compareKey,a.tableNames[b].primaryKeyIds.length),new Map()])).get(b))}function t(b,e){var f=s(b);f[0];f=f[1];return c("nullthrows")((f.has(e)?f:f.set(e,c("IntervalList")((l||(l=d("ReStoreKeyComparer"))).compareKey,a.tableNames[b].indexes[e].length))).get(e))}function u(b,e,f,g,h,i){var j=function(a,c){return r(e,b.findIntersecting,i,a,c)},m=f==null?void 0:d("LSStorage").searchKey(a,e,f,h),n=g==null?void 0:d("LSStorage").searchKey(a,e,g,h);if(n==null&&m!=null)return j(m,{operation:"delete",prevValue:f});if(m==null&&n!=null)return j(n,{operation:"add",value:c("nullthrows")(g)});if(m!=null&&n!=null)return(l||(l=d("ReStoreKeyComparer"))).compareKey(m,n)===0?j(m,{operation:"put",prevValue:f,value:c("nullthrows")(g)}):(k||(k=d("PromiseOrValue"))).map(j(m,{operation:"delete",prevValue:f}),function(){return j(n,{operation:"add",value:c("nullthrows")(g)})})}function v(a,b,c,e){var f=s(a),g=f[0],h=f[1];return(k||(k=d("PromiseOrValue"))).map(u(g,a,b,c,null,e),function(){return(k||(k=d("PromiseOrValue"))).all(Array.from(h.entries()).map(function(d){var f=d[0];d=d[1];return u(d,a,b,c,f,e)}).filter(function(a){return a!=null}))})}function w(){m.forEach(function(a){return a()})}function x(a,b){function d(){var d=new Map();try{for(var f of a){var g=f[0],h=f[1];e(b,g)&&d.set(g,h)}}catch(a){c("FBLogger")("messenger_web_product").catching(a).mustfix("Couldnot format changes to broadcast")}return Array.from(d)}if((i||(i=c("ExecutionEnvironment"))).isInBrowser&&f!=null){d=d();if(d.length===0)return;f.postMessage(b,d)}}(i||(i=c("ExecutionEnvironment"))).isInBrowser&&(f!=null&&f.onEventReceive("notifyTableV2",function(a){c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=new WeakMap(),c=a.values();yield (k||(k=d("PromiseOrValue"))).loop(function(a){if(a.done)return{action:"break",value:void 0};a=a.value;var e=a[0];a=a[1];var f=a.values();return(k||(k=d("PromiseOrValue"))).map(k.loop(function(a){if(a.done)return{action:"break",value:void 0};a=a.value;var c=a[0];a=a[1];return(k||(k=d("PromiseOrValue"))).map(v(e,c,a,b),function(){return{action:"continue",value:f.next()}})},f.next()),function(){return{action:"continue",value:c.next()}})},c.next());w()})())}));var y=new Map(),z=new Map();function A(a,b){if(b==null)return null;var c=y.get(a);c==null&&(c=new Map(),y.set(a,c));var d=[];for(b of b){var e=c.get(b);if(e==null){e=c.size;c.set(b,e);var f=z.get(a);f==null&&(f=[],z.set(a,f));f.push(b)}f=e>>5;e=e&31;d[f]=((f=d[f])!=null?f:0)|1<<e}return d}return{dispose:function(){g.clear(),m.clear()},notifyCommit:w,notifyTableAndIndexSubscribers:v,notifyTableV2:x,subscribeIndex:function(a,c,d,e,f){var g=t(a,c),i=!1;c=function(a,c,e){return i?(h||(h=b("Promise"))).resolve():q(d,a,c,e)};var j=[c,A(a,f)];g.set(e,j);return function(){i=!0,g["delete"](j)}},subscribeTable:function(a,c,d,e){var f=s(a),g=f[0],i=!1;f=function(a,d,e){return i?(h||(h=b("Promise"))).resolve():q(c,a,d,e)};var j=[f,A(a,e)];g.set(d,j);return function(){i=!0,g["delete"](j)}},subscribeToCommit:function(a){m.set(a,a);return function(){m["delete"](a)}}}}g["default"]=a}),98);
__d("ReStore",["ExecutionEnvironment","FBLogger","I64","LSPlatformLsInitLog","LSStorage","LSTableDefaults","MessengerLogHistory","MetaConfig","Promise","PromiseOrValue","ReQLBounds","ReStoreDefaultValueMigration","ReStoreDefaultValuesMetadata","ReStoreHooks","ReStoreIndicesMigration","ReStoreKeyComparer","ReStorePersistence","ReStorePersistenceIds","ReStoreTransactionLock","ReStoreUtils","asyncToGeneratorRuntime","clearTimeout","cr:1088","cr:1242","createReStoreSubscriptionManager","err","gkx","hashString","isPromise","nullthrows","promiseDone","setImmediate","setTimeout","unrecoverableViolation"],(function(a,b,c,d,e,f,g){"use strict";var h,i,j,k,l,m,n,o=d("MessengerLogHistory").getInstance("db_init");e=function(a){babelHelpers.inheritsLoose(b,a);function b(){return a.call(this,"Transaction has finished")||this}return b}(babelHelpers.wrapNativeSuper(Error));function p(a){a=(n||(n=d("I64"))).cast(a);if(a===void 0)throw c("unrecoverableViolation")("Expected int64","messenger_web_product");return n.to_float(a)}function q(a,b){function d(b){if(b.done)return b.value;if(!(j||(j=c("isPromise")))(b.value))throw c("unrecoverableViolation")("expected promise","messenger_web_product");return b.value.then(function(b){return d(a.next(b))})}return d(a.next(b))}function r(a,b){return{next:function(c){return b.chainPromiseOrValue(function(b){return q(a.next(b,c))})}}}function s(a,b,c){return(a.has(b)?a:a.set(b,c())).get(b)}function a(a,e,f){f===void 0&&(f=[]);var g=d("ReStorePersistence").createDbStore(a),j=a.tabTablesNotifier==null?void 0:a.tabTablesNotifier(),u=c("createReStoreSubscriptionManager")(e,a.shouldSync,j),v=d("ReStoreHooks").createHookManager(f),w=b("LSStorage").searchKey.bind(null,e),x={background:{first:null,last:null},sync_script:{first:null,last:null},ui:{first:null,last:null}},y=c("hashString")(JSON.stringify(e)),z=c("hashString")(JSON.stringify(c("LSTableDefaults")));d("LSPlatformLsInitLog").addAnnotations({"int":{defaultValuesVersion:z,schemaVersion:y}});d("LSPlatformLsInitLog").addPoint("migration_start");o.debug("restore migration start");var A=new(d("ReStoreTransactionLock").WaitForPromiseLock)(g.runExclusively(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){d("LSPlatformLsInitLog").addPoint("migration_execute_start");var a=new Map(),b=g.createTransaction("readwrite"),f=W(b,a);if(c("MetaConfig")._("59")){var h,i;h=(h=(yield q(b.table(d("ReStoreDefaultValuesMetadata").schemaVersionTableName).readData(new WeakMap(),d("ReStorePersistenceIds").idForSchema))))==null?void 0:h.schemaVersion;i=(i=(yield q(b.table(d("ReStoreDefaultValuesMetadata").schemaVersionTableName).readData(new WeakMap(),d("ReStorePersistenceIds").idForDefaultValue))))==null?void 0:i.defaultValuesVersion;h!=null&&d("LSPlatformLsInitLog").addAnnotations({"int":{storeDefaultValuesVersion:i,storeSchemaVersion:h}});if(h===y&&i===z){b.close();o.debug("restore migration skipped");d("LSPlatformLsInitLog").addPoint("migration_skipped");return}}try{yield d("ReStoreDefaultValueMigration").runMigrationForTableDefaultValuesIfNeeded(f,e);yield d("ReStoreIndicesMigration").runMigrationForIndicesIfNeeded(f,e,function(c,e){return new(d("ReStoreTransactionLock").ReStoreTransactionLock)().chainPromiseOrValue(function(d){return q(V(a,b,new WeakMap(),c,e,d))})});d("LSPlatformLsInitLog").addPoint("migration_execute_end");o.debug("restore migration complete");h=!0;c("MetaConfig")._("59")&&(a.size===0&&(h=!1),b.table(d("ReStoreDefaultValuesMetadata").schemaVersionTableName).writeData(new WeakMap(),d("ReStorePersistenceIds").idForSchema,{schemaVersion:y}),b.table(d("ReStoreDefaultValuesMetadata").schemaVersionTableName).writeData(new WeakMap(),d("ReStorePersistenceIds").idForDefaultValue,{defaultValuesVersion:z}));yield b.flush({upgrade:h})}catch(a){b.close();throw a}d("LSPlatformLsInitLog").addPoint("migration_end");o.debug("restore migration end")}))["catch"](function(a){d("LSPlatformLsInitLog").addAnnotations({string:{migration_error:a.message}});d("LSPlatformLsInitLog").fail("migration_error");o.debug("restore migration error");throw a})),B=new Map();function C(a,b){return D.apply(this,arguments)}function D(){D=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,c){var e=new WeakMap();yield g.runExclusively(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var b=new Map(),f=g.createTransaction("readwrite"),h=W(f,b),i=c.values();yield (k||(k=d("PromiseOrValue"))).loop(function(b){if(b.done)return{action:"break",value:void 0};b=b.value;var c=b[0],f=b[1];return(k||(k=d("PromiseOrValue"))).map(k.map(f==null?h.table(a)["delete"](w(a,c)):h.table(a).put(f),function(){return u.notifyTableAndIndexSubscribers(a,c,f,e)}),function(){return{action:"continue",value:i.next()}})},i.next());try{yield f.flush({upgrade:!0})}catch(a){f.close();throw a}}))});return D.apply(this,arguments)}function E(a,b,c,d,e){b=JSON.stringify([b,c]);c=a.get(b);a.set(b,[c==null?d:c[0],e])}function F(a,b,c,d,e,f){return G.apply(this,arguments)}function G(){G=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,d,e,f){f=a.table(c);a=(yield q(f.readId(b,d,e)));if(a===void 0)return void 0;d=(yield q(f.readDataExn(b,a)));return v.afterGet({tableName:c,value:d})});return G.apply(this,arguments)}function H(a,b,c,d,e,f){return I.apply(this,arguments)}function I(){I=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,c,d,e,f){a=(yield F(a,b,c,d,e,f));return a===void 0?void 0:w(c,a)});return I.apply(this,arguments)}function J(a,b,c,f,g,h){function i(){var k=a.table(c),j=k.idEntries(b,f,babelHelpers["extends"]({},(l||(l=d("ReQLBounds"))).extendBounds(h,(f===void 0?e.tableNames[c].primaryKeyIds:e.tableNames[c].indexes[f]).length),{dir:g}));return k={next:function*(a,b){a=(yield* j.next(b));return a.done?{done:!0}:{done:!1,value:a.value[0]}}},k[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]=i,k}return i()}function K(a,b,c,f,g,h){function i(){var k,m=a.table(c),j=m.idEntries(b,f,babelHelpers["extends"]({},(l||(l=d("ReQLBounds"))).extendBounds(h,(f===void 0?e.tableNames[c].primaryKeyIds:e.tableNames[c].indexes[f]).length),{dir:g}));return k={next:function*(a,d){a=(yield* j.next(d));if(a.done)return{done:!0};d=(yield* m.readDataExn(b,a.value[1]));return{done:!1,value:[a.value[0],v.afterEntriesNext({tableName:c,value:d})]}}},k[typeof Symbol==="function"?Symbol.iterator:"@@iterator"]=i,k}return i()}function* L(a,b,c,f,g,h,i){function j(a,b){return a.length>=b?a:[].concat(a,[(m||(m=d("ReStoreKeyComparer"))).MAX_KEY])}if(h!=null&&(m||(m=d("ReStoreKeyComparer"))).compareKey(g,h)===0)return;f=e.tableNames[f];var k=f.cascadeUpdates,l=f.primaryKeyIds;f=function*(d){var f=d.indexName;d=d.tableName;var k=e.tableNames[d],m=k.indexes;k=k.primaryKeyIds;var n=f==null?k:m[f];k={gte:g,lte:j(g,n.length)};m=K(b,c,d,f,"asc",k);f=[];k=(yield* m.next(i));while(!k.done)f.push(k.value),k=(yield* m.next(i));for(m of f){m[0];k=m[1];f=w(d,k);if(h===void 0)yield* Q(a,b,c,d,f,i),yield* L(a,b,c,d,f,void 0,i);else{k=l.reduce(function(a,b,c){if(c>=h.length)return a;a[n[c]]=h[c];return a},babelHelpers["extends"]({},k));yield* P(a,b,c,d,f,k,i);yield* L(a,b,c,d,f,w(d,k),i)}}};for(k of k)yield* f(k)}function M(a,b,c,d){return N.apply(this,arguments)}function N(){N=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a,b,f,g){g=e.tableNames[f].autoIncrement;if(!g)throw c("unrecoverableViolation")("only supported for auto-incrementing tables","messenger_web_product");g=(yield q(a.table(f).readSeed(b)));if(g===void 0)throw c("unrecoverableViolation")("unexpected undefined autoIncrementSeed","messenger_web_product");return(n||(n=d("I64"))).of_float(g)});return N.apply(this,arguments)}function* O(a,b,c,f,g,h){var i=b.table(f),j=e.tableNames[f];if(j.autoIncrement){var k=g[j.primaryKeyIds[0]];k=(n||(n=d("I64"))).of_float(yield* i.incrementSeed(c,k===void 0?k:p(k)));g[j.primaryKeyIds[0]]=k}k=w(f,g);var l={},o=(yield* i.readId(c,void 0,k)),q,r=g;o!==void 0?(q=(yield* i.readDataExn(c,o)),l=R(Object.keys(j.indexes),f,q),i.writeData(c,o,r)):(r=d("ReStoreUtils").appendDefaultValues(g,j.name),o=(yield* i.writeNewData(c,r)),yield* i.writeId(c,void 0,k,o));g=R(Object.keys(j.indexes),f,r);for(j of Object.keys(g))l[j]!==void 0&&(m||(m=d("ReStoreKeyComparer"))).compareKey(l[j],g[j])===0&&(delete g[j],delete l[j]);yield* S(a,b,c,f,g,h);yield* T(b,c,f,o,g);for(j of Object.keys(l))yield* i.removeId(c,j,l[j]);E(a,f,k,q,r)}function* P(a,b,c,e,f,g,h){var i=w(e,g);d("LSStorage").areKeysEqual(f,i)||(yield* Q(a,b,c,e,f,h));yield* O(a,b,c,e,g,h)}function* Q(a,b,c,d,f,g){g=b.table(d);b=e.tableNames[d];var h=(yield* g.readId(c,void 0,f)),i;if(h!==void 0){i=(yield* g.readDataExn(c,h));if(Object.keys(b.indexes).length)for(b of Object.keys(b.indexes)){var j=w(d,i,b);j!=null&&(yield* g.removeId(c,b,j))}yield* g.removeId(c,void 0,f);g.remove(c,h);E(a,d,f,i,void 0)}}function R(a,b,c){return a.reduce(function(a,d){var e=w(b,c,d);a[d]=e;return a},{})}function* S(a,b,c,d,e,f){var g=b.table(d),h=new Set();for(var i of Object.keys(e)){var j=e[i];j=(yield* g.readId(c,i,j));if(j!=null&&!h.has(j)){var k=w(d,yield* g.readDataExn(c,j));yield* Q(a,b,c,d,k,f);yield* L(a,b,c,d,k,void 0,f);h.add(j)}}}function* T(a,b,c,d,e){a=a.table(c);for(c of Object.keys(e)){var f=e[c];yield* a.writeId(b,c,f,d)}}function* U(a,b,c,f,g,h){var i=b.table(f),j=e.tableNames[f];if(j.autoIncrement){var k=g[j.primaryKeyIds[0]];k=(n||(n=d("I64"))).of_float(yield* i.incrementSeed(c,k===void 0?k:p(k)));g[j.primaryKeyIds[0]]=k}k=d("ReStoreUtils").appendDefaultValues(g,j.name);g=w(f,k);if(g==null)throw new Error("Evaluating the object store's key path did not yield a value");if((yield* i.readId(c,void 0,g))==null){j=R(Object.keys(j.indexes),f,k);yield* S(a,b,c,f,j,h);h=(yield* i.writeNewData(c,k));yield* i.writeId(c,void 0,g,h);yield* T(b,c,f,h,j);E(a,f,g,void 0,k)}}function* V(a,b,d,f,g,h){var i=b.table(f);for(var j of g)yield* i.clearIds(d,j);j=g.filter(function(a){var b;return((b=e.tableNames[f])==null?void 0:b.indexes[a])!=null});if(j.length===0)return;g=K(b,d,f,void 0,"asc",void 0);var k=[],l=(yield* g.next(h));while(!l.done)k.push(l.value),l=(yield* g.next(h));for(g of k){l=g[0];k=g[1];k=R(j,f,k);yield* S(a,b,d,f,k,h);l=c("nullthrows")(yield* i.readId(d,void 0,l));yield* T(b,d,f,l,k)}}function W(a,c,f){var g=new(d("ReStoreTransactionLock").ReStoreTransactionLock)(),i=new WeakMap(),j=f==null?void 0:f.instanceKey;function l(b){return g.chainPromiseOrValue(function(c){var e=a.createNested();return(k||(k=d("PromiseOrValue"))).map(b(c,e),function(a){e.flush();return a})})}var m={table:function(f){return{add:function(a){return(h||(h=b("Promise"))).resolve((k||(k=d("PromiseOrValue"))).map(v.beforeAdd({tableName:f,transaction:m,value:a}),function(a){return l(function(d,e){b("cr:1242")==null?void 0:b("cr:1242").recordLogicalWrite(j);return q(U(c,e,i,f,a,d))})}))},"delete":function(){for(var a=arguments.length,d=new Array(a),e=0;e<a;e++)d[e]=arguments[e];return(h||(h=b("Promise"))).resolve(l(function(a,e){return q(function*(){b("cr:1242")==null?void 0:b("cr:1242").recordLogicalWrite(j),yield* Q(c,e,i,f,d,a),yield* L(c,e,i,f,d,void 0,a)}())}))},deleteThenInsert:function(a){return(h||(h=b("Promise"))).resolve((k||(k=d("PromiseOrValue"))).map(v.beforeDeleteThenInsert({tableName:f,transaction:m,value:d("ReStoreUtils").appendDefaultValues(a,f)}),function(a){return l(function(d,e){return q(function*(){b("cr:1242")==null?void 0:b("cr:1242").recordLogicalWrite(j),yield* O(c,e,i,f,a,d),yield* L(c,e,i,f,w(f,a),void 0,d)}())})}))},entries:function(b,c,d){c===void 0&&(c="asc");return r(K(a,i,f,void 0,c,d),g)},get:function(){for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return(h||(h=b("Promise"))).resolve(g.chainPromiseOrValue(function(b){return F(a,i,f,void 0,d,b)}))},index:function(c){return{entries:function(b,d,e){d===void 0&&(d="asc");return r(K(a,i,f,c,d,e),g)},get:function(){for(var d=arguments.length,e=new Array(d),j=0;j<d;j++)e[j]=arguments[j];return(h||(h=b("Promise"))).resolve(g.chainPromiseOrValue(function(b){return F(a,i,f,c,e,b)}))},getKey:function(){for(var d=arguments.length,e=new Array(d),j=0;j<d;j++)e[j]=arguments[j];return(h||(h=b("Promise"))).resolve(g.chainPromiseOrValue(function(b){return H(a,i,f,c,e,b)}))},keyFields:e.tableNames[f].indexes[c],keys:function(b,d,e){d===void 0&&(d="asc");return r(J(a,i,f,c,d,e),g)}}},keyFields:e.tableNames[f].primaryKeyIds,keys:function(b,c,d){c===void 0&&(c="asc");return r(J(a,i,f,void 0,c,d),g)},peekNextAutoIncrementId:function(){return(h||(h=b("Promise"))).resolve(g.chainPromiseOrValue(function(b){return M(a,i,f,b)}))},put:function(a){return(h||(h=b("Promise"))).resolve((k||(k=d("PromiseOrValue"))).map(v.beforePut({tableName:f,transaction:m,value:a}),function(a){return l(function(d,e){b("cr:1242")==null?void 0:b("cr:1242").recordLogicalWrite(j);return q(O(c,e,i,f,a,d))})}))},upsert:function(a,e){return(h||(h=b("Promise"))).resolve((k||(k=d("PromiseOrValue"))).map(v.beforeUpsert({tableName:f,transaction:m,value:e}),function(d){return l(function(g,h){return q(function*(){b("cr:1242")==null?void 0:b("cr:1242").recordLogicalWrite(j),yield* P(c,h,i,f,a,d,g),yield* L(c,h,i,f,a,w(f,e),g)}())})}))}}}};return m}var X;function Y(a,d){return new(h||(h=b("Promise")))(function(b,e){c("gkx")("789")&&(X=e),x[d].last==null?x[d].first=x[d].last={value:function(){return a().then(b,e)}}:x[d].last=x[d].last.next={value:function(){return a().then(b,e)}}})}function Z(){return g.runExclusively(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){var a=x.ui.first!=null?x.ui:x.sync_script.first!=null?x.sync_script:x.background;if(a.first==null){c("FBLogger")("messenger_web_product").mustfix("Expected work is missing");return}var b=a.first;a.first===a.last&&(a.last=null);a.first=a.first.next;yield b.value()}))}function aa(a,b,c){return $.apply(this,arguments)}function $(){$=b("asyncToGeneratorRuntime").asyncToGenerator(function*(e,f,i){i===void 0&&(i="background");var j,l,m,n,o,p,q=b("cr:1242")==null?void 0:b("cr:1242").startTracking(a.types,i);(c("MetaConfig")._("26")||c("MetaConfig")._("27")||b("cr:1088"))&&(j=c("err")("Transaction timeout"));b("cr:1088")&&(l=Date.now());function f(){return r.apply(this,arguments)}function r(){r=b("asyncToGeneratorRuntime").asyncToGenerator(function*(){b("cr:1242")==null?void 0:b("cr:1242").mark(q,"execute_start");b("cr:1088")&&(m=Date.now());var a={ref:void 0},f=new Map(),i=g.createTransaction("readwrite"),r;try{var s=W(i,f,{instanceKey:q});r=(yield (h||(h=b("Promise"))).race([e(s),t(j,a)]));a.ref!=null&&c("clearTimeout")(a.ref);b("cr:1088")&&(n=Date.now());b("cr:1242")==null?void 0:b("cr:1242").mark(q,"execute_end");b("cr:1242")==null?void 0:b("cr:1242").mark(q,"flush_start");yield i.flush({instanceKey:q});b("cr:1242")==null?void 0:b("cr:1242").mark(q,"flush_end")}catch(d){a.ref!=null&&c("clearTimeout")(a.ref);i.close();b("cr:1242")==null?void 0:b("cr:1242").fail(q);throw d}b("cr:1088")&&(p=Date.now());b("cr:1242")==null?void 0:b("cr:1242").mark(q,"broadcast_start");var w=new WeakMap(),x=new Map();for(s of f){a=s[0];i=s[1];a=JSON.parse(a);var y=a[0];a[1];a=x.get(y);a==null&&(a=[],x.set(y,a));var z=i[0];i=i[1];i=v.beforeNotify({newValue:i,prevValue:z,tableName:y});z=i.newValue;y=i.prevValue;a.push([y,z])}var A=x.entries();yield (k||(k=d("PromiseOrValue"))).loop(function(b){if(b.done)return{action:"break",value:void 0};b=b.value;var a=b[0];b=b[1];var c=b.values();return(k||(k=d("PromiseOrValue"))).map(k.loop(function(b){if(b.done)return{action:"break",value:void 0};b=b.value;var e=b[0];b=b[1];return(k||(k=d("PromiseOrValue"))).map(u.notifyTableAndIndexSubscribers(a,e,b,w),function(){return{action:"continue",value:c.next()}})},c.next()),function(){return{action:"continue",value:A.next()}})},A.next());yield g.queueCommitWork(function(){u.notifyTableV2(x,"notifyTableV2");u.notifyTableV2(x,"notifyInMemoryTable");return(h||(h=b("Promise"))).resolve()});u.notifyCommit();if(b("cr:1088")){o=Date.now();i={broadcast:o,complete:n,flush:p,queue:l,start:m};b("cr:1088").recordRestoreTransaction(j,i,{changedKeys:f})}b("cr:1242")==null?void 0:b("cr:1242").mark(q,"broadcast_end");b("cr:1242")==null?void 0:b("cr:1242").mark(q,"post_commit_start");c("setImmediate")(function(){b("cr:1242")==null?void 0:b("cr:1242").mark(q,"post_commit_end"),b("cr:1242")==null?void 0:b("cr:1242").end(q)});return r});return r.apply(this,arguments)}var s=i==="background"&&c("MetaConfig")._("39")?new(h||(h=b("Promise")))(function(a){return c("setTimeout")(a,0)}):(h||(h=b("Promise"))).resolve();yield s;s=Y(f,i);c("promiseDone")(Z(),function(){},function(a){X==null?void 0:X(a)});return s});return $.apply(this,arguments)}(i||(i=c("ExecutionEnvironment"))).isInBrowser&&(j!=null&&j.onEventReceive("notifyInMemoryTable",function(d){c("promiseDone")(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){for(var b of d){var c=b[0],e=b[1];a.shouldApplySync("notifyInMemoryTable",c)&&(yield C(c,e))}u.notifyCommit()})())}));return{clearCacheIfSupported:function(){var a=g;a instanceof Object&&a.clearCache!==void 0&&a.clearCache instanceof Function&&a.clearCache()},closeDb:function(){var a=g;a instanceof Object&&a.close!==void 0&&a.close()},getTableData:function(){return e},isClosed:function(){return g.isClosed()},persistenceTypes:a.types,runInTransaction:aa,subscribeToCommit:function(a){return u.subscribeToCommit(a)},subscriptionManager:u,table:function(a){return s(B,a,function(){var c=new Map();return{entries:function(b,c,d){c===void 0&&(c="asc");return r(K(g.createTransaction("readonly"),b,a,void 0,c,d),A)},get:function(){for(var b=arguments.length,c=new Array(b),d=0;d<b;d++)c[d]=arguments[d];return A.chainPromiseOrValue(function(b){return F(g.createTransaction("readonly"),new WeakMap(),a,void 0,c,b)})},index:function(b){return s(c,b,function(){return{entries:function(c,d,e){d===void 0&&(d="asc");return r(K(g.createTransaction("readonly"),c,a,b,d,e),A)},get:function(){for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return A.chainPromiseOrValue(function(c){return F(g.createTransaction("readonly"),new WeakMap(),a,b,d,c)})},getKey:function(){for(var c=arguments.length,d=new Array(c),e=0;e<c;e++)d[e]=arguments[e];return A.chainPromiseOrValue(function(c){return H(g.createTransaction("readonly"),new WeakMap(),a,b,d,c)})},keyFields:e.tableNames[a].indexes[b],keys:function(c,d,e){d===void 0&&(d="asc");return r(J(g.createTransaction("readonly"),c,a,b,d,e),A)},subscribe:function(c,f,g){return u.subscribeIndex(a,b,c,(l||(l=d("ReQLBounds"))).extendBounds(f,e.tableNames[a].indexes[b].length),g)}}})},keyFields:e.tableNames[a].primaryKeyIds,keys:function(b,c,d){c===void 0&&(c="asc");return r(J(g.createTransaction("readonly"),b,a,void 0,c,d),A)},peekNextAutoIncrementId:function(){return(h||(h=b("Promise"))).resolve(A.chainPromiseOrValue(function(b){return M(g.createTransaction("readonly"),new WeakMap(),a,b)}))},subscribe:function(b,c,f){return u.subscribeTable(a,b,(l||(l=d("ReQLBounds"))).extendBounds(c,e.tableNames[a].primaryKeyIds.length),f)}}})}}}function t(a,d){return(i||(i=c("ExecutionEnvironment"))).canUseDOM&&c("MetaConfig")._("27")?new(h||(h=b("Promise")))(function(b,e){var f=5e3;d.ref=c("setTimeout")(function(){c("FBLogger")("messenger_web_product").catching(a).blameToPreviousFrame().mustfix("ReStore transaction took longer than %s ms to execute",f.toString()),e(a)},f)}):new(h||(h=b("Promise")))(function(){})}a.TransactionClosedError=e;g["default"]=a}),98);
__d("createReStoreEphemeralPersistence",["FBLogger","Promise","ReStorePersistence","asyncToGeneratorRuntime"],(function(a,b,c,d,e,f,g){"use strict";var h;function i(a,b,c){return(a.has(b)?a:a.set(b,c())).get(b)}function a(){var a=(h||(h=b("Promise"))).resolve(),e=new Map();function f(a){return i(e,a,function(){return new Map()})}return{flush:function(){var a=b("asyncToGeneratorRuntime").asyncToGenerator(function*(a){a.forEach(function(a,b){var c=f(b);a.forEach(function(a,b){d("ReStorePersistence").isDeletedValue(a)?c["delete"](b):c.set(b,a)})})});function c(b){return a.apply(this,arguments)}return c}(),get:function(a,b,c){a=f(b);return a.get(c)},logError:function(a,b,d,e){if(d==="dbCorruption"){throw c("FBLogger")("messenger_web_product").mustfixThrow("Got unexpected undefined in edb, mode: %s, table: %s, id: %s, deletedInThisTxn: %s",b,a,(d=e==null?void 0:e.id)!=null?d:"",(b=e==null?void 0:e.deletedInThisTxn)!=null?b:"")}},queueCommitWork:void 0,runExclusively:function(c){return new(h||(h=b("Promise")))(function(d,e){a=a.then(b("asyncToGeneratorRuntime").asyncToGenerator(function*(){try{d(yield c())}catch(a){e(a)}}))})},shouldApplySync:function(){return!1},shouldSync:function(){return!1},types:["ephemeral"],uniqueId:""}}g["default"]=a}),98);